

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>fmgr_ips_sensor &mdash; Fortinet Ansible Modules 1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="fmgr_provisioning" href="fmgr_provisioning.html" />
    <link rel="prev" title="fmgr_ha" href="fmgr_ha.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Fortinet Ansible Modules
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../fmgr_root.html">FortiManager</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../fmgr_modules.html">Modules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="fmgr_device.html">fmgr_device</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_device_config.html">fmgr_device_config</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_device_group.html">fmgr_device_group</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_device_provision_template.html">fmgr_device_provision_template</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_fortimeter.html">fmgr_fortimeter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_fwobj_address.html">fmgr_fwobj_address</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_fwobj_service.html">fmgr_fwobj_service</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_fwpol_ipv4.html">fmgr_fwpol_ipv4</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_fwpol_package.html">fmgr_fwpol_package</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_ha.html">fmgr_ha</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">fmgr_ips_sensor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-metadata-parameters">Module Metadata / Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-source-code">Module Source Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_provisioning.html">fmgr_provisioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_query.html">fmgr_query</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_script.html">fmgr_script</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_secprof_av.html">fmgr_secprof_av</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_sys_proxy.html">fmgr_sys_proxy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../fmgr_playbooks.html">Playbook Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fmgr_roles.html">Roles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faz_root.html">FortiAnalyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fortios_root.html">FortiGate (FortiOS)</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Fortinet Ansible Modules</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../fmgr_root.html">FortiManager</a> &raquo;</li>
        
          <li><a href="../fmgr_modules.html">Modules</a> &raquo;</li>
        
      <li>fmgr_ips_sensor</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/fmgr_modules/fmgr_ips_sensor.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="fmgr-ips-sensor">
<h1>fmgr_ips_sensor<a class="headerlink" href="#fmgr-ips-sensor" title="Permalink to this headline">¶</a></h1>
<p>Not Parsed</p>
<div class="section" id="module-metadata-parameters">
<h2>Module Metadata / Parameters<a class="headerlink" href="#module-metadata-parameters" title="Permalink to this headline">¶</a></h2>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span>module: fmgr_ips_sensor
version_added: &quot;2.8&quot;
author:
    - Luke Weighall (@lweighall)
    - Andrew Welsh (@Ghilli3)
    - Jim Huber (@p4r4n0y1ng)
short_description: %%SHORT_DESC%% # TODO UPDATE THIS!
description: #TODO UPDATE THIS!
  -  %%LONG_DESC%%

options:
  adom:
    description:
      - The ADOM the configuration should belong to.
    required: false
    default: root

  host:
    description:
      - The FortiManager&#39;s Address.
    required: true

  username:
    description:
      - The username associated with the account.
    required: true

  password:
    description:
      - The password associated with the username account.
    required: true

  mode:
    description:
      - Sets one of three modes for managing the object.
      - Allows use of soft-adds instead of overwriting existing values
    choices: [&#39;add&#39;, &#39;set&#39;, &#39;delete&#39;, &#39;update&#39;]
    required: false
    default: add

  replacemsg_group:
    description:
      - Replacement message group.
    required: false

  name:
    description:
      - Sensor name.
    required: false

  extended_log:
    description:
      - Enable/disable extended logging.
      - choice | disable | Disable setting.
      - choice | enable | Enable setting.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  comment:
    description:
      - Comment.
    required: false

  block_malicious_url:
    description:
      - Enable/disable malicious URL blocking.
      - choice | disable | Disable malicious URL blocking.
      - choice | enable | Enable malicious URL blocking.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  entries:
    description:
      - EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
      - List of multiple child objects to be added. Expects a list of dictionaries.
      - Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
      - If submitted, all other prefixed sub-parameters ARE IGNORED. This object is MUTUALLY EXCLUSIVE with its options.
      - We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
      - WHEN IN DOUBT, OMIT THE USE OF THIS PARAMETER AND USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
    required: false

  entries_action:
    description:
      - Action taken with traffic in which signatures are detected.
      - choice | pass | Pass or allow matching traffic.
      - choice | block | Block or drop matching traffic.
      - choice | reset | Reset sessions for matching traffic.
      - choice | default | Pass or drop matching traffic, depending on the default action of the signature.
    required: false
    choices: [&quot;pass&quot;, &quot;block&quot;, &quot;reset&quot;, &quot;default&quot;]

  entries_application:
    description:
      - Applications to be protected. set application ? lists available applications. all includes all applications. other includes all unlisted applications.
    required: false

  entries_location:
    description:
      - Protect client or server traffic.
    required: false

  entries_log:
    description:
      - Enable/disable logging of signatures included in filter.
      - choice | disable | Disable logging of selected rules.
      - choice | enable | Enable logging of selected rules.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  entries_log_attack_context:
    description:
      - Enable/disable logging of attack context: URL buffer, header buffer, body buffer, packet buffer.
      - choice | disable | Disable logging of detailed attack context.
      - choice | enable | Enable logging of detailed attack context.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  entries_log_packet:
    description:
      - Enable/disable packet logging. Enable to save the packet that triggers the filter. You can download the packets in pcap format for diagnostic use.
      - choice | disable | Disable packet logging of selected rules.
      - choice | enable | Enable packet logging of selected rules.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  entries_os:
    description:
      - Operating systems to be protected.  all includes all operating systems. other includes all unlisted operating systems.
    required: false

  entries_protocol:
    description:
      - Protocols to be examined. set protocol ? lists available protocols. all includes all protocols. other includes all unlisted protocols.
    required: false

  entries_quarantine:
    description:
      - Quarantine method.
      - choice | none | Quarantine is disabled.
      - choice | attacker | Block all traffic sent from attacker&#39;s IP address. The attacker&#39;s IP address is also added to the banned user list. The target&#39;s address is not affected.
    required: false
    choices: [&quot;none&quot;, &quot;attacker&quot;]

  entries_quarantine_expiry:
    description:
      - Duration of quarantine. (Format ###d##h##m, minimum 1m, maximum 364d23h59m, default = 5m). Requires quarantine set to attacker.
    required: false

  entries_quarantine_log:
    description:
      - Enable/disable quarantine logging.
      - choice | disable | Disable quarantine logging.
      - choice | enable | Enable quarantine logging.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  entries_rate_count:
    description:
      - Count of the rate.
    required: false

  entries_rate_duration:
    description:
      - Duration (sec) of the rate.
    required: false

  entries_rate_mode:
    description:
      - Rate limit mode.
      - choice | periodical | Allow configured number of packets every rate-duration.
      - choice | continuous | Block packets once the rate is reached.
    required: false
    choices: [&quot;periodical&quot;, &quot;continuous&quot;]

  entries_rate_track:
    description:
      - Track the packet protocol field.
      - choice | none |
      - choice | src-ip | Source IP.
      - choice | dest-ip | Destination IP.
      - choice | dhcp-client-mac | DHCP client.
      - choice | dns-domain | DNS domain.
    required: false
    choices: [&quot;none&quot;, &quot;src-ip&quot;, &quot;dest-ip&quot;, &quot;dhcp-client-mac&quot;, &quot;dns-domain&quot;]

  entries_rule:
    description:
      - Identifies the predefined or custom IPS signatures to add to the sensor.
    required: false

  entries_severity:
    description:
      - Relative severity of the signature, from info to critical. Log messages generated by the signature include the severity.
    required: false

  entries_status:
    description:
      - Status of the signatures included in filter. default enables the filter and only use filters with default status of enable. Filters with default status of disable will not be used.
      - choice | disable | Disable status of selected rules.
      - choice | enable | Enable status of selected rules.
      - choice | default | Default.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;, &quot;default&quot;]

  entries_exempt_ip_dst_ip:
    description:
      - Destination IP address and netmask.
    required: false

  entries_exempt_ip_src_ip:
    description:
      - Source IP address and netmask.
    required: false

  filter:
    description:
      - EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
      - List of multiple child objects to be added. Expects a list of dictionaries.
      - Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
      - If submitted, all other prefixed sub-parameters ARE IGNORED. This object is MUTUALLY EXCLUSIVE with its options.
      - We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
      - WHEN IN DOUBT, OMIT THE USE OF THIS PARAMETER AND USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
    required: false

  filter_action:
    description:
      - Action of selected rules.
      - choice | pass | Pass or allow matching traffic.
      - choice | block | Block or drop matching traffic.
      - choice | default | Pass or drop matching traffic, depending on the default action of the signature.
      - choice | reset | Reset sessions for matching traffic.
    required: false
    choices: [&quot;pass&quot;, &quot;block&quot;, &quot;default&quot;, &quot;reset&quot;]

  filter_application:
    description:
      - Vulnerable application filter.
    required: false

  filter_location:
    description:
      - Vulnerability location filter.
    required: false

  filter_log:
    description:
      - Enable/disable logging of selected rules.
      - choice | disable | Disable logging of selected rules.
      - choice | enable | Enable logging of selected rules.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  filter_log_packet:
    description:
      - Enable/disable packet logging of selected rules.
      - choice | disable | Disable packet logging of selected rules.
      - choice | enable | Enable packet logging of selected rules.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  filter_name:
    description:
      - Filter name.
    required: false

  filter_os:
    description:
      - Vulnerable OS filter.
    required: false

  filter_protocol:
    description:
      - Vulnerable protocol filter.
    required: false

  filter_quarantine:
    description:
      - Quarantine IP or interface.
      - choice | none | Quarantine is disabled.
      - choice | attacker | Block all traffic sent from attacker&#39;s IP address. The attacker&#39;s IP address is also added to the banned user list. The target&#39;s address is not affected.
    required: false
    choices: [&quot;none&quot;, &quot;attacker&quot;]

  filter_quarantine_expiry:
    description:
      - Duration of quarantine in minute.
    required: false

  filter_quarantine_log:
    description:
      - Enable/disable logging of selected quarantine.
      - choice | disable | Disable logging of selected quarantine.
      - choice | enable | Enable logging of selected quarantine.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  filter_severity:
    description:
      - Vulnerability severity filter.
    required: false

  filter_status:
    description:
      - Selected rules status.
      - choice | disable | Disable status of selected rules.
      - choice | enable | Enable status of selected rules.
      - choice | default | Default.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;, &quot;default&quot;]

  override:
    description:
      - EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
      - List of multiple child objects to be added. Expects a list of dictionaries.
      - Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
      - If submitted, all other prefixed sub-parameters ARE IGNORED. This object is MUTUALLY EXCLUSIVE with its options.
      - We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
      - WHEN IN DOUBT, OMIT THE USE OF THIS PARAMETER AND USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
    required: false

  override_action:
    description:
      - Action of override rule.
      - choice | pass | Pass or allow matching traffic.
      - choice | block | Block or drop matching traffic.
      - choice | reset | Reset sessions for matching traffic.
    required: false
    choices: [&quot;pass&quot;, &quot;block&quot;, &quot;reset&quot;]

  override_log:
    description:
      - Enable/disable logging.
      - choice | disable | Disable logging.
      - choice | enable | Enable logging.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  override_log_packet:
    description:
      - Enable/disable packet logging.
      - choice | disable | Disable packet logging.
      - choice | enable | Enable packet logging.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  override_quarantine:
    description:
      - Quarantine IP or interface.
      - choice | none | Quarantine is disabled.
      - choice | attacker | Block all traffic sent from attacker&#39;s IP address. The attacker&#39;s IP address is also added to the banned user list. The target&#39;s address is not affected.
    required: false
    choices: [&quot;none&quot;, &quot;attacker&quot;]

  override_quarantine_expiry:
    description:
      - Duration of quarantine in minute.
    required: false

  override_quarantine_log:
    description:
      - Enable/disable logging of selected quarantine.
      - choice | disable | Disable logging of selected quarantine.
      - choice | enable | Enable logging of selected quarantine.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  override_rule_id:
    description:
      - Override rule ID.
    required: false

  override_status:
    description:
      - Enable/disable status of override rule.
      - choice | disable | Disable status of override rule.
      - choice | enable | Enable status of override rule.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  override_exempt_ip_dst_ip:
    description:
      - Destination IP address and netmask.
    required: false

  override_exempt_ip_src_ip:
    description:
      - Source IP address and netmask.
    required: false
</pre></div>
</div>
</div>
<div class="section" id="module-source-code">
<h2>Module Source Code<a class="headerlink" href="#module-source-code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span>#!/usr/bin/python
#
# This file is part of Ansible
#
# Ansible is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# Ansible is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with Ansible.  If not, see &lt;http://www.gnu.org/licenses/&gt;.
#

from __future__ import absolute_import, division, print_function

__metaclass__ = type

ANSIBLE_METADATA = {&#39;status&#39;: [&#39;preview&#39;],
                    &#39;supported_by&#39;: &#39;community&#39;,
                    &#39;metadata_version&#39;: &#39;1.1&#39;}

DOCUMENTATION = &#39;&#39;&#39;
---
module: fmgr_ips_sensor
version_added: &quot;2.8&quot;
author:
    - Luke Weighall (@lweighall)
    - Andrew Welsh (@Ghilli3)
    - Jim Huber (@p4r4n0y1ng)
short_description: %%SHORT_DESC%% # TODO UPDATE THIS!
description: #TODO UPDATE THIS!
  -  %%LONG_DESC%%

options:
  adom:
    description:
      - The ADOM the configuration should belong to.
    required: false
    default: root

  host:
    description:
      - The FortiManager&#39;s Address.
    required: true

  username:
    description:
      - The username associated with the account.
    required: true

  password:
    description:
      - The password associated with the username account.
    required: true

  mode:
    description:
      - Sets one of three modes for managing the object.
      - Allows use of soft-adds instead of overwriting existing values
    choices: [&#39;add&#39;, &#39;set&#39;, &#39;delete&#39;, &#39;update&#39;]
    required: false
    default: add

  replacemsg_group:
    description:
      - Replacement message group.
    required: false

  name:
    description:
      - Sensor name.
    required: false

  extended_log:
    description:
      - Enable/disable extended logging.
      - choice | disable | Disable setting.
      - choice | enable | Enable setting.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  comment:
    description:
      - Comment.
    required: false

  block_malicious_url:
    description:
      - Enable/disable malicious URL blocking.
      - choice | disable | Disable malicious URL blocking.
      - choice | enable | Enable malicious URL blocking.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  entries:
    description:
      - EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
      - List of multiple child objects to be added. Expects a list of dictionaries.
      - Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
      - If submitted, all other prefixed sub-parameters ARE IGNORED. This object is MUTUALLY EXCLUSIVE with its options.
      - We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
      - WHEN IN DOUBT, OMIT THE USE OF THIS PARAMETER AND USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
    required: false

  entries_action:
    description:
      - Action taken with traffic in which signatures are detected.
      - choice | pass | Pass or allow matching traffic.
      - choice | block | Block or drop matching traffic.
      - choice | reset | Reset sessions for matching traffic.
      - choice | default | Pass or drop matching traffic, depending on the default action of the signature.
    required: false
    choices: [&quot;pass&quot;, &quot;block&quot;, &quot;reset&quot;, &quot;default&quot;]

  entries_application:
    description:
      - Applications to be protected. set application ? lists available applications. all includes all applications. other includes all unlisted applications.
    required: false

  entries_location:
    description:
      - Protect client or server traffic.
    required: false

  entries_log:
    description:
      - Enable/disable logging of signatures included in filter.
      - choice | disable | Disable logging of selected rules.
      - choice | enable | Enable logging of selected rules.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  entries_log_attack_context:
    description:
      - Enable/disable logging of attack context: URL buffer, header buffer, body buffer, packet buffer.
      - choice | disable | Disable logging of detailed attack context.
      - choice | enable | Enable logging of detailed attack context.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  entries_log_packet:
    description:
      - Enable/disable packet logging. Enable to save the packet that triggers the filter. You can download the packets in pcap format for diagnostic use.
      - choice | disable | Disable packet logging of selected rules.
      - choice | enable | Enable packet logging of selected rules.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  entries_os:
    description:
      - Operating systems to be protected.  all includes all operating systems. other includes all unlisted operating systems.
    required: false

  entries_protocol:
    description:
      - Protocols to be examined. set protocol ? lists available protocols. all includes all protocols. other includes all unlisted protocols.
    required: false

  entries_quarantine:
    description:
      - Quarantine method.
      - choice | none | Quarantine is disabled.
      - choice | attacker | Block all traffic sent from attacker&#39;s IP address. The attacker&#39;s IP address is also added to the banned user list. The target&#39;s address is not affected.
    required: false
    choices: [&quot;none&quot;, &quot;attacker&quot;]

  entries_quarantine_expiry:
    description:
      - Duration of quarantine. (Format ###d##h##m, minimum 1m, maximum 364d23h59m, default = 5m). Requires quarantine set to attacker.
    required: false

  entries_quarantine_log:
    description:
      - Enable/disable quarantine logging.
      - choice | disable | Disable quarantine logging.
      - choice | enable | Enable quarantine logging.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  entries_rate_count:
    description:
      - Count of the rate.
    required: false

  entries_rate_duration:
    description:
      - Duration (sec) of the rate.
    required: false

  entries_rate_mode:
    description:
      - Rate limit mode.
      - choice | periodical | Allow configured number of packets every rate-duration.
      - choice | continuous | Block packets once the rate is reached.
    required: false
    choices: [&quot;periodical&quot;, &quot;continuous&quot;]

  entries_rate_track:
    description:
      - Track the packet protocol field.
      - choice | none |
      - choice | src-ip | Source IP.
      - choice | dest-ip | Destination IP.
      - choice | dhcp-client-mac | DHCP client.
      - choice | dns-domain | DNS domain.
    required: false
    choices: [&quot;none&quot;, &quot;src-ip&quot;, &quot;dest-ip&quot;, &quot;dhcp-client-mac&quot;, &quot;dns-domain&quot;]

  entries_rule:
    description:
      - Identifies the predefined or custom IPS signatures to add to the sensor.
    required: false

  entries_severity:
    description:
      - Relative severity of the signature, from info to critical. Log messages generated by the signature include the severity.
    required: false

  entries_status:
    description:
      - Status of the signatures included in filter. default enables the filter and only use filters with default status of enable. Filters with default status of disable will not be used.
      - choice | disable | Disable status of selected rules.
      - choice | enable | Enable status of selected rules.
      - choice | default | Default.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;, &quot;default&quot;]

  entries_exempt_ip_dst_ip:
    description:
      - Destination IP address and netmask.
    required: false

  entries_exempt_ip_src_ip:
    description:
      - Source IP address and netmask.
    required: false

  filter:
    description:
      - EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
      - List of multiple child objects to be added. Expects a list of dictionaries.
      - Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
      - If submitted, all other prefixed sub-parameters ARE IGNORED. This object is MUTUALLY EXCLUSIVE with its options.
      - We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
      - WHEN IN DOUBT, OMIT THE USE OF THIS PARAMETER AND USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
    required: false

  filter_action:
    description:
      - Action of selected rules.
      - choice | pass | Pass or allow matching traffic.
      - choice | block | Block or drop matching traffic.
      - choice | default | Pass or drop matching traffic, depending on the default action of the signature.
      - choice | reset | Reset sessions for matching traffic.
    required: false
    choices: [&quot;pass&quot;, &quot;block&quot;, &quot;default&quot;, &quot;reset&quot;]

  filter_application:
    description:
      - Vulnerable application filter.
    required: false

  filter_location:
    description:
      - Vulnerability location filter.
    required: false

  filter_log:
    description:
      - Enable/disable logging of selected rules.
      - choice | disable | Disable logging of selected rules.
      - choice | enable | Enable logging of selected rules.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  filter_log_packet:
    description:
      - Enable/disable packet logging of selected rules.
      - choice | disable | Disable packet logging of selected rules.
      - choice | enable | Enable packet logging of selected rules.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  filter_name:
    description:
      - Filter name.
    required: false

  filter_os:
    description:
      - Vulnerable OS filter.
    required: false

  filter_protocol:
    description:
      - Vulnerable protocol filter.
    required: false

  filter_quarantine:
    description:
      - Quarantine IP or interface.
      - choice | none | Quarantine is disabled.
      - choice | attacker | Block all traffic sent from attacker&#39;s IP address. The attacker&#39;s IP address is also added to the banned user list. The target&#39;s address is not affected.
    required: false
    choices: [&quot;none&quot;, &quot;attacker&quot;]

  filter_quarantine_expiry:
    description:
      - Duration of quarantine in minute.
    required: false

  filter_quarantine_log:
    description:
      - Enable/disable logging of selected quarantine.
      - choice | disable | Disable logging of selected quarantine.
      - choice | enable | Enable logging of selected quarantine.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  filter_severity:
    description:
      - Vulnerability severity filter.
    required: false

  filter_status:
    description:
      - Selected rules status.
      - choice | disable | Disable status of selected rules.
      - choice | enable | Enable status of selected rules.
      - choice | default | Default.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;, &quot;default&quot;]

  override:
    description:
      - EXPERTS ONLY! KNOWLEDGE OF FMGR JSON API IS REQUIRED!
      - List of multiple child objects to be added. Expects a list of dictionaries.
      - Dictionaries must use FortiManager API parameters, not the ansible ones listed below.
      - If submitted, all other prefixed sub-parameters ARE IGNORED. This object is MUTUALLY EXCLUSIVE with its options.
      - We expect that you know what you are doing with these list parameters, and are leveraging the JSON API Guide.
      - WHEN IN DOUBT, OMIT THE USE OF THIS PARAMETER AND USE THE SUB OPTIONS BELOW INSTEAD TO CREATE OBJECTS WITH MULTIPLE TASKS
    required: false

  override_action:
    description:
      - Action of override rule.
      - choice | pass | Pass or allow matching traffic.
      - choice | block | Block or drop matching traffic.
      - choice | reset | Reset sessions for matching traffic.
    required: false
    choices: [&quot;pass&quot;, &quot;block&quot;, &quot;reset&quot;]

  override_log:
    description:
      - Enable/disable logging.
      - choice | disable | Disable logging.
      - choice | enable | Enable logging.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  override_log_packet:
    description:
      - Enable/disable packet logging.
      - choice | disable | Disable packet logging.
      - choice | enable | Enable packet logging.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  override_quarantine:
    description:
      - Quarantine IP or interface.
      - choice | none | Quarantine is disabled.
      - choice | attacker | Block all traffic sent from attacker&#39;s IP address. The attacker&#39;s IP address is also added to the banned user list. The target&#39;s address is not affected.
    required: false
    choices: [&quot;none&quot;, &quot;attacker&quot;]

  override_quarantine_expiry:
    description:
      - Duration of quarantine in minute.
    required: false

  override_quarantine_log:
    description:
      - Enable/disable logging of selected quarantine.
      - choice | disable | Disable logging of selected quarantine.
      - choice | enable | Enable logging of selected quarantine.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  override_rule_id:
    description:
      - Override rule ID.
    required: false

  override_status:
    description:
      - Enable/disable status of override rule.
      - choice | disable | Disable status of override rule.
      - choice | enable | Enable status of override rule.
    required: false
    choices: [&quot;disable&quot;, &quot;enable&quot;]

  override_exempt_ip_dst_ip:
    description:
      - Destination IP address and netmask.
    required: false

  override_exempt_ip_src_ip:
    description:
      - Source IP address and netmask.
    required: false


&#39;&#39;&#39;

EXAMPLES = &#39;&#39;&#39;
- name: EDIT FMGR_IPS_SENSOR
  fmgr_ips_sensor:
    host: &quot;{{ inventory_hostname }}&quot;
    username: &quot;{{ username }}&quot;
    password: &quot;{{ password }}&quot;
    mode:
    adom:
    replacemsg_group:
    name:
    extended_log:
    comment:
    block_malicious_url:
    entries_action:
    entries_application:
    entries_location:
    entries_log:
    entries_log_attack_context:
    entries_log_packet:
    entries_os:
    entries_protocol:
    entries_quarantine:
    entries_quarantine_expiry:
    entries_quarantine_log:
    entries_rate_count:
    entries_rate_duration:
    entries_rate_mode:
    entries_rate_track:
    entries_rule:
    entries_severity:
    entries_status:
    entries_exempt_ip_dst_ip:
    entries_exempt_ip_src_ip:
    filter_action:
    filter_application:
    filter_location:
    filter_log:
    filter_log_packet:
    filter_name:
    filter_os:
    filter_protocol:
    filter_quarantine:
    filter_quarantine_expiry:
    filter_quarantine_log:
    filter_severity:
    filter_status:
    override_action:
    override_log:
    override_log_packet:
    override_quarantine:
    override_quarantine_expiry:
    override_quarantine_log:
    override_rule_id:
    override_status:
    override_exempt_ip_dst_ip:
    override_exempt_ip_src_ip:

    list_overrides = [&#39;entries&#39;, &#39;filter&#39;, &#39;override&#39;]

        override_data = list()

            override_data = module.params[list_variable]

            pass


                del paramgram[list_variable]
                paramgram[list_variable] = override_data

            pass
&#39;&#39;&#39;

RETURN = &quot;&quot;&quot;
api_result:
  description: full API response, includes status code and message
  returned: always
  type: string
&quot;&quot;&quot;

from ansible.module_utils.basic import AnsibleModule, env_fallback
from ansible.module_utils.network.fortimanager.fortimanager import AnsibleFortiManager

# TODO - REMOVE THIS IMPORT TRY/EXCEPT BEFORE SUBMITTING TO PR
# TRY TO IMPORT THE DEBUG/TEST MODULE IF NOT MOVE ON
log_requests = False
try:
    from ansible.module_utils.network.fortimanager.fortimanager_debug import log_pyfmg

    log_requests = True
except BaseException:
    pass

# check for pyFMG lib
try:
    from pyFMG.fortimgr import FortiManager

    HAS_PYFMGR = True
except ImportError:
    HAS_PYFMGR = False


###############
# START METHODS
###############


def fmgr_ips_sensor_addsetdelete(fmg, paramgram):
    &quot;&quot;&quot;
    fmgr_ips_sensor -- Your Description here, bruh
    &quot;&quot;&quot;

    mode = paramgram[&quot;mode&quot;]
    adom = paramgram[&quot;adom&quot;]
    # INIT A BASIC OBJECTS
    response = (-100000, {&quot;msg&quot;: &quot;Illegal or malformed paramgram discovered. System Exception&quot;})
    url = &quot;&quot;
    datagram = {}

    # EVAL THE MODE PARAMETER FOR SET OR ADD
    if mode in [&#39;set&#39;, &#39;add&#39;, &#39;update&#39;]:
        url = &#39;/pm/config/adom/{adom}/obj/ips/sensor&#39;.format(adom=adom)
        datagram = fmgr_del_none(fmgr_prepare_dict(paramgram))

    # EVAL THE MODE PARAMETER FOR DELETE
    elif mode == &quot;delete&quot;:
        # SET THE CORRECT URL FOR DELETE
        url = &#39;/pm/config/adom/{adom}/obj/ips/sensor/{name}&#39;.format(adom=adom, name=paramgram[&quot;name&quot;])
        datagram = {}

    # IF MODE = SET -- USE THE &#39;SET&#39; API CALL MODE
    if mode == &quot;set&quot;:
        response = fmg.set(url, datagram)
    # IF MODE = UPDATE -- USER THE &#39;UPDATE&#39; API CALL MODE
    elif mode == &quot;update&quot;:
        response = fmg.update(url, datagram)
    # IF MODE = ADD  -- USE THE &#39;ADD&#39; API CALL MODE
    elif mode == &quot;add&quot;:
        response = fmg.add(url, datagram)
    # IF MODE = DELETE  -- USE THE DELETE URL AND API CALL MODE
    elif mode == &quot;delete&quot;:
        response = fmg.delete(url, datagram)

    # TODO - REMOVE THE LOG_REQUESTS AND LOG_PYFMG AND THIS COMMENT BEFORE SUBMITTING TO PR
    if log_requests:
        log_pyfmg(response, paramgram, url, mode)

    return response


# ADDITIONAL COMMON FUNCTIONS
# FUNCTION/METHOD FOR LOGGING OUT AND ANALYZING ERROR CODES
def fmgr_logout(fmg, module, msg=&quot;NULL&quot;, results=(), good_codes=(0,), logout_on_fail=True, logout_on_success=False):
    &quot;&quot;&quot;
    THIS METHOD CONTROLS THE LOGOUT AND ERROR REPORTING AFTER AN METHOD OR FUNCTION RUNS
    &quot;&quot;&quot;
    # pydevd.settrace(&#39;10.0.0.122&#39;, port=54654, stdoutToServer=True, stderrToServer=True)
    # VALIDATION ERROR (NO RESULTS, JUST AN EXIT)
    if msg != &quot;NULL&quot; and len(results) == 0:
        try:
            fmg.logout()
        except:
            pass
        module.fail_json(msg=msg)

    # SUBMISSION ERROR
    if len(results) &gt; 0:
        if msg == &quot;NULL&quot;:
            try:
                msg = results[1][&#39;status&#39;][&#39;message&#39;]
            except:
                msg = &quot;No status message returned from pyFMG. Possible that this was a GET with a tuple result.&quot;

        if results[0] not in good_codes:
            if logout_on_fail:
                fmg.logout()
                module.fail_json(msg=msg, **results[1])
            else:
                return msg
        else:
            if logout_on_success:
                fmg.logout()
                module.exit_json(msg=&quot;API Called worked, but logout handler has been asked to logout on success&quot;,
                                 **results[1])
            else:
                return msg


# FUNCTION/METHOD FOR CONVERTING CIDR TO A NETMASK
# DID NOT USE IP ADDRESS MODULE TO KEEP INCLUDES TO A MINIMUM
def fmgr_cidr_to_netmask(cidr):
    cidr = int(cidr)
    mask = (0xffffffff &gt;&gt; (32 - cidr)) &lt;&lt; (32 - cidr)
    return (str((0xff000000 &amp; mask) &gt;&gt; 24) + &#39;.&#39; +
            str((0x00ff0000 &amp; mask) &gt;&gt; 16) + &#39;.&#39; +
            str((0x0000ff00 &amp; mask) &gt;&gt; 8) + &#39;.&#39; +
            str((0x000000ff &amp; mask)))


# utility function: removing keys wih value of None, nothing in playbook for that key
def fmgr_del_none(obj):
    if isinstance(obj, dict):
        return type(obj)((fmgr_del_none(k), fmgr_del_none(v))
                         for k, v in obj.items() if k is not None and (v is not None and not fmgr_is_empty_dict(v)))
    else:
        return obj


# utility function: remove keys that are need for the logic but the FMG API won&#39;t accept them
def fmgr_prepare_dict(obj):
    list_of_elems = [&quot;mode&quot;, &quot;adom&quot;, &quot;host&quot;, &quot;username&quot;, &quot;password&quot;]
    if isinstance(obj, dict):
        obj = dict((key, fmgr_prepare_dict(value)) for (key, value) in obj.items() if key not in list_of_elems)
    return obj


def fmgr_is_empty_dict(obj):
    # pydevd.settrace(&#39;10.0.0.122&#39;, port=54654, stdoutToServer=True, stderrToServer=True)
    return_val = False
    if isinstance(obj, dict):
        if len(obj) &gt; 0:
            for k, v in obj.items():
                if isinstance(v, dict):
                    if len(v) == 0:
                        return_val = True
                    elif len(v) &gt; 0:
                        for k1, v1 in v.items():
                            if v1 is None:
                                return_val = True
                            elif v1 is not None:
                                return_val = False
                                return return_val
                elif v is None:
                    return_val = True
                elif v is not None:
                    return_val = False
                    return return_val
        elif len(obj) == 0:
            return_val = True

    return return_val


#############
# END METHODS
#############


def main():
    argument_spec = dict(
        adom=dict(type=&quot;str&quot;, default=&quot;root&quot;),
        host=dict(required=True, type=&quot;str&quot;),
        password=dict(fallback=(env_fallback, [&quot;ANSIBLE_NET_PASSWORD&quot;]), no_log=True, required=True),
        username=dict(fallback=(env_fallback, [&quot;ANSIBLE_NET_USERNAME&quot;]), no_log=True, required=True),
        mode=dict(choices=[&quot;add&quot;, &quot;set&quot;, &quot;delete&quot;, &quot;update&quot;], type=&quot;str&quot;, default=&quot;add&quot;),

        replacemsg_group=dict(required=False, type=&quot;str&quot;),
        name=dict(required=False, type=&quot;str&quot;),
        extended_log=dict(required=False, type=&quot;str&quot;, choices=[&quot;disable&quot;, &quot;enable&quot;]),
        comment=dict(required=False, type=&quot;str&quot;),
        block_malicious_url=dict(required=False, type=&quot;str&quot;, choices=[&quot;disable&quot;, &quot;enable&quot;]),
        entries=dict(required=False, type=&quot;list&quot;),
        entries_action=dict(required=False, type=&quot;str&quot;, choices=[&quot;pass&quot;, &quot;block&quot;, &quot;reset&quot;, &quot;default&quot;]),
        entries_application=dict(required=False, type=&quot;str&quot;),
        entries_location=dict(required=False, type=&quot;str&quot;),
        entries_log=dict(required=False, type=&quot;str&quot;, choices=[&quot;disable&quot;, &quot;enable&quot;]),
        entries_log_attack_context=dict(required=False, type=&quot;str&quot;, choices=[&quot;disable&quot;, &quot;enable&quot;]),
        entries_log_packet=dict(required=False, type=&quot;str&quot;, choices=[&quot;disable&quot;, &quot;enable&quot;]),
        entries_os=dict(required=False, type=&quot;str&quot;),
        entries_protocol=dict(required=False, type=&quot;str&quot;),
        entries_quarantine=dict(required=False, type=&quot;str&quot;, choices=[&quot;none&quot;, &quot;attacker&quot;]),
        entries_quarantine_expiry=dict(required=False, type=&quot;str&quot;),
        entries_quarantine_log=dict(required=False, type=&quot;str&quot;, choices=[&quot;disable&quot;, &quot;enable&quot;]),
        entries_rate_count=dict(required=False, type=&quot;int&quot;),
        entries_rate_duration=dict(required=False, type=&quot;int&quot;),
        entries_rate_mode=dict(required=False, type=&quot;str&quot;, choices=[&quot;periodical&quot;, &quot;continuous&quot;]),
        entries_rate_track=dict(required=False, type=&quot;str&quot;,
                                choices=[&quot;none&quot;, &quot;src-ip&quot;, &quot;dest-ip&quot;, &quot;dhcp-client-mac&quot;, &quot;dns-domain&quot;]),
        entries_rule=dict(required=False, type=&quot;str&quot;),
        entries_severity=dict(required=False, type=&quot;str&quot;),
        entries_status=dict(required=False, type=&quot;str&quot;, choices=[&quot;disable&quot;, &quot;enable&quot;, &quot;default&quot;]),

        entries_exempt_ip_dst_ip=dict(required=False, type=&quot;str&quot;),
        entries_exempt_ip_src_ip=dict(required=False, type=&quot;str&quot;),
        filter=dict(required=False, type=&quot;list&quot;),
        filter_action=dict(required=False, type=&quot;str&quot;, choices=[&quot;pass&quot;, &quot;block&quot;, &quot;default&quot;, &quot;reset&quot;]),
        filter_application=dict(required=False, type=&quot;str&quot;),
        filter_location=dict(required=False, type=&quot;str&quot;),
        filter_log=dict(required=False, type=&quot;str&quot;, choices=[&quot;disable&quot;, &quot;enable&quot;]),
        filter_log_packet=dict(required=False, type=&quot;str&quot;, choices=[&quot;disable&quot;, &quot;enable&quot;]),
        filter_name=dict(required=False, type=&quot;str&quot;),
        filter_os=dict(required=False, type=&quot;str&quot;),
        filter_protocol=dict(required=False, type=&quot;str&quot;),
        filter_quarantine=dict(required=False, type=&quot;str&quot;, choices=[&quot;none&quot;, &quot;attacker&quot;]),
        filter_quarantine_expiry=dict(required=False, type=&quot;int&quot;),
        filter_quarantine_log=dict(required=False, type=&quot;str&quot;, choices=[&quot;disable&quot;, &quot;enable&quot;]),
        filter_severity=dict(required=False, type=&quot;str&quot;),
        filter_status=dict(required=False, type=&quot;str&quot;, choices=[&quot;disable&quot;, &quot;enable&quot;, &quot;default&quot;]),
        override=dict(required=False, type=&quot;list&quot;),
        override_action=dict(required=False, type=&quot;str&quot;, choices=[&quot;pass&quot;, &quot;block&quot;, &quot;reset&quot;]),
        override_log=dict(required=False, type=&quot;str&quot;, choices=[&quot;disable&quot;, &quot;enable&quot;]),
        override_log_packet=dict(required=False, type=&quot;str&quot;, choices=[&quot;disable&quot;, &quot;enable&quot;]),
        override_quarantine=dict(required=False, type=&quot;str&quot;, choices=[&quot;none&quot;, &quot;attacker&quot;]),
        override_quarantine_expiry=dict(required=False, type=&quot;int&quot;),
        override_quarantine_log=dict(required=False, type=&quot;str&quot;, choices=[&quot;disable&quot;, &quot;enable&quot;]),
        override_rule_id=dict(required=False, type=&quot;str&quot;),
        override_status=dict(required=False, type=&quot;str&quot;, choices=[&quot;disable&quot;, &quot;enable&quot;]),

        override_exempt_ip_dst_ip=dict(required=False, type=&quot;str&quot;),
        override_exempt_ip_src_ip=dict(required=False, type=&quot;str&quot;),

    )

    module = AnsibleModule(argument_spec, supports_check_mode=False)

    # MODULE PARAMGRAM
    paramgram = {
        &quot;mode&quot;: module.params[&quot;mode&quot;],
        &quot;adom&quot;: module.params[&quot;adom&quot;],
        &quot;replacemsg-group&quot;: module.params[&quot;replacemsg_group&quot;],
        &quot;name&quot;: module.params[&quot;name&quot;],
        &quot;extended-log&quot;: module.params[&quot;extended_log&quot;],
        &quot;comment&quot;: module.params[&quot;comment&quot;],
        &quot;block-malicious-url&quot;: module.params[&quot;block_malicious_url&quot;],
        &quot;entries&quot;: {
            &quot;action&quot;: module.params[&quot;entries_action&quot;],
            &quot;application&quot;: module.params[&quot;entries_application&quot;],
            &quot;location&quot;: module.params[&quot;entries_location&quot;],
            &quot;log&quot;: module.params[&quot;entries_log&quot;],
            &quot;log-attack-context&quot;: module.params[&quot;entries_log_attack_context&quot;],
            &quot;log-packet&quot;: module.params[&quot;entries_log_packet&quot;],
            &quot;os&quot;: module.params[&quot;entries_os&quot;],
            &quot;protocol&quot;: module.params[&quot;entries_protocol&quot;],
            &quot;quarantine&quot;: module.params[&quot;entries_quarantine&quot;],
            &quot;quarantine-expiry&quot;: module.params[&quot;entries_quarantine_expiry&quot;],
            &quot;quarantine-log&quot;: module.params[&quot;entries_quarantine_log&quot;],
            &quot;rate-count&quot;: module.params[&quot;entries_rate_count&quot;],
            &quot;rate-duration&quot;: module.params[&quot;entries_rate_duration&quot;],
            &quot;rate-mode&quot;: module.params[&quot;entries_rate_mode&quot;],
            &quot;rate-track&quot;: module.params[&quot;entries_rate_track&quot;],
            &quot;rule&quot;: module.params[&quot;entries_rule&quot;],
            &quot;severity&quot;: module.params[&quot;entries_severity&quot;],
            &quot;status&quot;: module.params[&quot;entries_status&quot;],
            &quot;exempt-ip&quot;: {
                &quot;dst-ip&quot;: module.params[&quot;entries_exempt_ip_dst_ip&quot;],
                &quot;src-ip&quot;: module.params[&quot;entries_exempt_ip_src_ip&quot;],
            },
        },
        &quot;filter&quot;: {
            &quot;action&quot;: module.params[&quot;filter_action&quot;],
            &quot;application&quot;: module.params[&quot;filter_application&quot;],
            &quot;location&quot;: module.params[&quot;filter_location&quot;],
            &quot;log&quot;: module.params[&quot;filter_log&quot;],
            &quot;log-packet&quot;: module.params[&quot;filter_log_packet&quot;],
            &quot;name&quot;: module.params[&quot;filter_name&quot;],
            &quot;os&quot;: module.params[&quot;filter_os&quot;],
            &quot;protocol&quot;: module.params[&quot;filter_protocol&quot;],
            &quot;quarantine&quot;: module.params[&quot;filter_quarantine&quot;],
            &quot;quarantine-expiry&quot;: module.params[&quot;filter_quarantine_expiry&quot;],
            &quot;quarantine-log&quot;: module.params[&quot;filter_quarantine_log&quot;],
            &quot;severity&quot;: module.params[&quot;filter_severity&quot;],
            &quot;status&quot;: module.params[&quot;filter_status&quot;],
        },
        &quot;override&quot;: {
            &quot;action&quot;: module.params[&quot;override_action&quot;],
            &quot;log&quot;: module.params[&quot;override_log&quot;],
            &quot;log-packet&quot;: module.params[&quot;override_log_packet&quot;],
            &quot;quarantine&quot;: module.params[&quot;override_quarantine&quot;],
            &quot;quarantine-expiry&quot;: module.params[&quot;override_quarantine_expiry&quot;],
            &quot;quarantine-log&quot;: module.params[&quot;override_quarantine_log&quot;],
            &quot;rule-id&quot;: module.params[&quot;override_rule_id&quot;],
            &quot;status&quot;: module.params[&quot;override_status&quot;],
            &quot;exempt-ip&quot;: {
                &quot;dst-ip&quot;: module.params[&quot;override_exempt_ip_dst_ip&quot;],
                &quot;src-ip&quot;: module.params[&quot;override_exempt_ip_src_ip&quot;],
            }
        }
    }
    list_overrides = [&#39;entries&#39;, &#39;filter&#39;, &#39;override&#39;]
    for list_variable in list_overrides:
        override_data = list()
        try:
            override_data = module.params[list_variable]
        except:
            pass
        try:
            if override_data:
                del paramgram[list_variable]
                paramgram[list_variable] = override_data
        except:
            pass

    # CHECK IF THE HOST/USERNAME/PW EXISTS, AND IF IT DOES, LOGIN.
    host = module.params[&quot;host&quot;]
    password = module.params[&quot;password&quot;]
    username = module.params[&quot;username&quot;]
    if host is None or username is None or password is None:
        module.fail_json(msg=&quot;Host and username and password are required&quot;)

    # CHECK IF LOGIN FAILED
    fmg = AnsibleFortiManager(module, module.params[&quot;host&quot;], module.params[&quot;username&quot;], module.params[&quot;password&quot;])

    response = fmg.login()
    if response[1][&#39;status&#39;][&#39;code&#39;] != 0:
        module.fail_json(msg=&quot;Connection to FortiManager Failed&quot;)

    results = fmgr_ips_sensor_addsetdelete(fmg, paramgram)
    if results[0] != 0:
        fmgr_logout(fmg, module, results=results, good_codes=[0])

    fmg.logout()

    if results is not None:
        return module.exit_json(**results[1])
    else:
        return module.exit_json(msg=&quot;No results were returned from the API call.&quot;)


if __name__ == &quot;__main__&quot;:
    main()
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="fmgr_provisioning.html" class="btn btn-neutral float-right" title="fmgr_provisioning" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="fmgr_ha.html" class="btn btn-neutral" title="fmgr_ha" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Fortinet North American Core CSE - DevOps.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>