

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>fmgr_device_provision_template &mdash; Fortinet Ansible Modules 1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="fmgr_fortimeter" href="fmgr_fortimeter.html" />
    <link rel="prev" title="fmgr_device_group" href="fmgr_device_group.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Fortinet Ansible Modules
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../fmgr_root.html">FortiManager</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../fmgr_modules.html">Modules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="fmgr_device.html">fmgr_device</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_device_config.html">fmgr_device_config</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_device_group.html">fmgr_device_group</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">fmgr_device_provision_template</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#metadata">Metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-source-code">Module Source Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_fortimeter.html">fmgr_fortimeter</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_fwobj_address.html">fmgr_fwobj_address</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_fwobj_service.html">fmgr_fwobj_service</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_fwobj_vip.html">fmgr_fwobj_vip</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_fwpol_ipv4.html">fmgr_fwpol_ipv4</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_fwpol_package.html">fmgr_fwpol_package</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_ha.html">fmgr_ha</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_ips_sensor.html">fmgr_ips_sensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_provisioning.html">fmgr_provisioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_query.html">fmgr_query</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_script.html">fmgr_script</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_secprof_appctrl.html">fmgr_secprof_appctrl</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_secprof_av.html">fmgr_secprof_av</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_secprof_dns.html">fmgr_secprof_dns</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_secprof_ips.html">fmgr_secprof_ips</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_secprof_profile_group.html">fmgr_secprof_profile_group</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_secprof_proxy.html">fmgr_secprof_proxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_secprof_spam.html">fmgr_secprof_spam</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_secprof_ssl_ssh.html">fmgr_secprof_ssl_ssh</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_secprof_voip.html">fmgr_secprof_voip</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_secprof_waf.html">fmgr_secprof_waf</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_secprof_wanopt.html">fmgr_secprof_wanopt</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_secprof_web.html">fmgr_secprof_web</a></li>
<li class="toctree-l3"><a class="reference internal" href="fmgr_sys_proxy.html">fmgr_sys_proxy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../fmgr_playbooks.html">Playbook Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fmgr_roles.html">Roles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faz_root.html">FortiAnalyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fortios_root.html">FortiGate (FortiOS)</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Fortinet Ansible Modules</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../fmgr_root.html">FortiManager</a> &raquo;</li>
        
          <li><a href="../fmgr_modules.html">Modules</a> &raquo;</li>
        
      <li>fmgr_device_provision_template</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/fmgr_modules/fmgr_device_provision_template.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="fmgr-device-provision-template">
<h1>fmgr_device_provision_template<a class="headerlink" href="#fmgr-device-provision-template" title="Permalink to this headline">¶</a></h1>
<div class="section" id="metadata">
<h2>Metadata<a class="headerlink" href="#metadata" title="Permalink to this headline">¶</a></h2>
<p><strong>Name:</strong> fmgr_device_provision_template</p>
<p><strong>Description:</strong> [‘Allows the editing and assignment of device provisioning templates in FortiManager’]</p>
<p><strong>Author(s):</strong> Luke Weighall, Andrew Welsh</p>
<p><strong>Ansible Version Added:</strong> 2.8</p>
</div>
<div class="section" id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h2>
<div class="section" id="admin-enable-fortiguard">
<h3>admin_enable_fortiguard<a class="headerlink" href="#admin-enable-fortiguard" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: enables fortiguard security updates to their default settings. (custom fortiguard servers not yet supported)</li>
<li>Required: False</li>
<li>choices: [‘none’, ‘direct’, ‘this-fmg’]</li>
</ul>
</div>
<div class="section" id="admin-fortianalyzer-target">
<h3>admin_fortianalyzer_target<a class="headerlink" href="#admin-fortianalyzer-target" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: configures faz target</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="admin-fortiguard-target">
<h3>admin_fortiguard_target<a class="headerlink" href="#admin-fortiguard-target" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Description: configures fortiguard target</p>
<p>admin_enable_fortiguard must be set to “direct”</p>
</li>
<li><p class="first">Required: False</p>
</li>
</ul>
</div>
<div class="section" id="admin-gui-theme">
<h3>admin_gui_theme<a class="headerlink" href="#admin-gui-theme" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: changes the admin gui theme</li>
<li>Required: False</li>
<li>choices: [‘green’, ‘red’, ‘blue’, ‘melongene’, ‘mariner’]</li>
</ul>
</div>
<div class="section" id="admin-http-port">
<h3>admin_http_port<a class="headerlink" href="#admin-http-port" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: nonssl admin gui port number</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="admin-https-port">
<h3>admin_https_port<a class="headerlink" href="#admin-https-port" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: ssl admin gui port number</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="admin-https-redirect">
<h3>admin_https_redirect<a class="headerlink" href="#admin-https-redirect" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: enables or disables https redirect from http</li>
<li>Required: False</li>
<li>choices: [‘enable’, ‘disable’]</li>
</ul>
</div>
<div class="section" id="admin-language">
<h3>admin_language<a class="headerlink" href="#admin-language" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: sets the admin gui language</li>
<li>Required: False</li>
<li>choices: [‘english’, ‘simch’, ‘japanese’, ‘korean’, ‘spanish’, ‘trach’, ‘french’, ‘portuguese’]</li>
</ul>
</div>
<div class="section" id="admin-switch-controller">
<h3>admin_switch_controller<a class="headerlink" href="#admin-switch-controller" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: enables or disables the switch controller</li>
<li>Required: False</li>
<li>choices: [‘enable’, ‘disable’]</li>
</ul>
</div>
<div class="section" id="admin-timeout">
<h3>admin_timeout<a class="headerlink" href="#admin-timeout" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: admin timeout in minutes</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="adom">
<h3>adom<a class="headerlink" href="#adom" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: The ADOM the configuration should belong to.</li>
<li>Required: True</li>
</ul>
</div>
<div class="section" id="delete-provisioning-template">
<h3>delete_provisioning_template<a class="headerlink" href="#delete-provisioning-template" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: If specified, all other options are ignored. The specified provisioning template will be deleted.</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="device-unique-name">
<h3>device_unique_name<a class="headerlink" href="#device-unique-name" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: The unique device’s name that you are editing</li>
<li>Required: True</li>
</ul>
</div>
<div class="section" id="dns-primary-ipv4">
<h3>dns_primary_ipv4<a class="headerlink" href="#dns-primary-ipv4" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: primary ipv4 dns forwarder</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="dns-secondary-ipv4">
<h3>dns_secondary_ipv4<a class="headerlink" href="#dns-secondary-ipv4" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: secondary ipv4 dns forwarder</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="dns-suffix">
<h3>dns_suffix<a class="headerlink" href="#dns-suffix" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: sets the local dns domain suffix</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="host">
<h3>host<a class="headerlink" href="#host" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: The FortiManager’s Address.</li>
<li>Required: True</li>
</ul>
</div>
<div class="section" id="ntp-auth">
<h3>ntp_auth<a class="headerlink" href="#ntp-auth" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: enables or disables ntp authentication</li>
<li>Required: False</li>
<li>choices: [‘enable’, ‘disable’]</li>
</ul>
</div>
<div class="section" id="ntp-auth-pwd">
<h3>ntp_auth_pwd<a class="headerlink" href="#ntp-auth-pwd" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: sets the ntp auth password</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="ntp-server">
<h3>ntp_server<a class="headerlink" href="#ntp-server" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: only used with custom ntp_type  specifies IP of server to sync to  comma separated ip addresses for multiples</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="ntp-status">
<h3>ntp_status<a class="headerlink" href="#ntp-status" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: enables or disables ntp</li>
<li>Required: False</li>
<li>choices: [‘enable’, ‘disable’]</li>
</ul>
</div>
<div class="section" id="ntp-sync-interval">
<h3>ntp_sync_interval<a class="headerlink" href="#ntp-sync-interval" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: sets the interval in minutes for ntp sync</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="ntp-type">
<h3>ntp_type<a class="headerlink" href="#ntp-type" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: enables fortiguard servers or custom servers are the ntp source</li>
<li>Required: False</li>
<li>choices: [‘fortiguard’, ‘custom’]</li>
</ul>
</div>
<div class="section" id="ntp-v3">
<h3>ntp_v3<a class="headerlink" href="#ntp-v3" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: enables or disables ntpv3 (default is ntpv4)</li>
<li>Required: False</li>
<li>choices: [‘enable’, ‘disable’]</li>
</ul>
</div>
<div class="section" id="password">
<h3>password<a class="headerlink" href="#password" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: The password associated with the username account.</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="provision-targets">
<h3>provision_targets<a class="headerlink" href="#provision-targets" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: The friendly names of devices in FortiManager to assign the provisioning template to. Comma separated list.</li>
<li>Required: True</li>
</ul>
</div>
<div class="section" id="provisioning-template">
<h3>provisioning_template<a class="headerlink" href="#provisioning-template" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: The provisioning template you want to apply (default = default)</li>
<li>Required: True</li>
</ul>
</div>
<div class="section" id="smtp-conn-sec">
<h3>smtp_conn_sec<a class="headerlink" href="#smtp-conn-sec" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: defines the ssl level for smtp</li>
<li>Required: False</li>
<li>choices: [‘none’, ‘starttls’, ‘smtps’]</li>
</ul>
</div>
<div class="section" id="smtp-password">
<h3>smtp_password<a class="headerlink" href="#smtp-password" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: smtp password</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="smtp-port">
<h3>smtp_port<a class="headerlink" href="#smtp-port" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: smtp port number</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="smtp-replyto">
<h3>smtp_replyto<a class="headerlink" href="#smtp-replyto" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: smtp reply to address</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="smtp-server">
<h3>smtp_server<a class="headerlink" href="#smtp-server" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: smtp server ipv4 address</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="smtp-source-ipv4">
<h3>smtp_source_ipv4<a class="headerlink" href="#smtp-source-ipv4" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: smtp source ip address</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="smtp-username">
<h3>smtp_username<a class="headerlink" href="#smtp-username" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: smtp auth username</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="smtp-validate-cert">
<h3>smtp_validate_cert<a class="headerlink" href="#smtp-validate-cert" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: enables or disables valid certificate checking for smtp</li>
<li>Required: False</li>
<li>choices: [‘enable’, ‘disable’]</li>
</ul>
</div>
<div class="section" id="snmp-status">
<h3>snmp_status<a class="headerlink" href="#snmp-status" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: enables or disables SNMP globally</li>
<li>Required: False</li>
<li>choices: [‘enable’, ‘disable’]</li>
</ul>
</div>
<div class="section" id="snmp-v2c-id">
<h3>snmp_v2c_id<a class="headerlink" href="#snmp-v2c-id" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: primary key for the snmp community. this must be unique!</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="snmp-v2c-name">
<h3>snmp_v2c_name<a class="headerlink" href="#snmp-v2c-name" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: specifies the v2c community name</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="snmp-v2c-query-hosts-ipv4">
<h3>snmp_v2c_query_hosts_ipv4<a class="headerlink" href="#snmp-v2c-query-hosts-ipv4" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: ipv4 addresses or subnets that are allowed to query SNMP v2c, comma separated (“10.7.220.59 255.255.255.0, 10.7.220.0 255.255.255.0”)</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="snmp-v2c-query-port">
<h3>snmp_v2c_query_port<a class="headerlink" href="#snmp-v2c-query-port" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: sets the snmp v2c community query port</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="snmp-v2c-query-status">
<h3>snmp_v2c_query_status<a class="headerlink" href="#snmp-v2c-query-status" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: enables or disables the v2c community specified for queries</li>
<li>Required: False</li>
<li>choices: [‘enable’, ‘disable’]</li>
</ul>
</div>
<div class="section" id="snmp-v2c-status">
<h3>snmp_v2c_status<a class="headerlink" href="#snmp-v2c-status" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: enables or disables the v2c community specified</li>
<li>Required: False</li>
<li>choices: [‘enable’, ‘disable’]</li>
</ul>
</div>
<div class="section" id="snmp-v2c-trap-hosts-ipv4">
<h3>snmp_v2c_trap_hosts_ipv4<a class="headerlink" href="#snmp-v2c-trap-hosts-ipv4" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: ipv4 addresses of the hosts that should get SNMP v2c traps, comma separated, must include mask (“10.7.220.59 255.255.255.255, 10.7.220.60 255.255.255.255”)</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="snmp-v2c-trap-port">
<h3>snmp_v2c_trap_port<a class="headerlink" href="#snmp-v2c-trap-port" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: sets the snmp v2c community trap port</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="snmp-v2c-trap-src-ipv4">
<h3>snmp_v2c_trap_src_ipv4<a class="headerlink" href="#snmp-v2c-trap-src-ipv4" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: source ip the traps should come from IPv4</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="snmp-v2c-trap-status">
<h3>snmp_v2c_trap_status<a class="headerlink" href="#snmp-v2c-trap-status" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: enables or disables the v2c community specified for traps</li>
<li>Required: False</li>
<li>choices: [‘enable’, ‘disable’]</li>
</ul>
</div>
<div class="section" id="snmpv3-auth-proto">
<h3>snmpv3_auth_proto<a class="headerlink" href="#snmpv3-auth-proto" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: snmpv3 auth protocol</li>
<li>Required: False</li>
<li>choices: [‘md5’, ‘sha’]</li>
</ul>
</div>
<div class="section" id="snmpv3-auth-pwd">
<h3>snmpv3_auth_pwd<a class="headerlink" href="#snmpv3-auth-pwd" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: snmpv3 auth pwd __ currently not encrypted! ensure this file is locked down permissions wise!</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="snmpv3-name">
<h3>snmpv3_name<a class="headerlink" href="#snmpv3-name" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: snmpv3 user name</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="snmpv3-notify-hosts">
<h3>snmpv3_notify_hosts<a class="headerlink" href="#snmpv3-notify-hosts" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: list of ipv4 hosts to send snmpv3 traps to. Comma separated IPv4 list</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="snmpv3-priv-proto">
<h3>snmpv3_priv_proto<a class="headerlink" href="#snmpv3-priv-proto" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: snmpv3 priv protocol</li>
<li>Required: False</li>
<li>choices: [‘aes’, ‘des’, ‘aes256’, ‘aes256cisco’]</li>
</ul>
</div>
<div class="section" id="snmpv3-priv-pwd">
<h3>snmpv3_priv_pwd<a class="headerlink" href="#snmpv3-priv-pwd" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: snmpv3 priv pwd __ currently not encrypted! ensure this file is locked down permissions wise!</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="snmpv3-queries">
<h3>snmpv3_queries<a class="headerlink" href="#snmpv3-queries" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: allow snmpv3_queries</li>
<li>Required: False</li>
<li>choices: [‘enable’, ‘disable’]</li>
</ul>
</div>
<div class="section" id="snmpv3-query-port">
<h3>snmpv3_query_port<a class="headerlink" href="#snmpv3-query-port" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: snmpv3 query port</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="snmpv3-security-level">
<h3>snmpv3_security_level<a class="headerlink" href="#snmpv3-security-level" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: snmpv3 security level</li>
<li>Required: False</li>
<li>choices: [‘no-auth-no-priv’, ‘auth-no-priv’, ‘auth-priv’]</li>
</ul>
</div>
<div class="section" id="snmpv3-source-ip">
<h3>snmpv3_source_ip<a class="headerlink" href="#snmpv3-source-ip" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: snmpv3 source ipv4 address for traps</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="snmpv3-status">
<h3>snmpv3_status<a class="headerlink" href="#snmpv3-status" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: snmpv3 user is enabled or disabled</li>
<li>Required: False</li>
<li>choices: [‘enable’, ‘disable’]</li>
</ul>
</div>
<div class="section" id="snmpv3-trap-rport">
<h3>snmpv3_trap_rport<a class="headerlink" href="#snmpv3-trap-rport" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: snmpv3 trap remote port</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="snmpv3-trap-status">
<h3>snmpv3_trap_status<a class="headerlink" href="#snmpv3-trap-status" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: snmpv3 traps is enabled or disabled</li>
<li>Required: False</li>
<li>choices: [‘enable’, ‘disable’]</li>
</ul>
</div>
<div class="section" id="state">
<h3>state<a class="headerlink" href="#state" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: The desired state of the specified object. absent will delete the object if it exists. present will create the configuration if needed.</li>
<li>Required: True</li>
<li>default: present</li>
<li>choices: [‘absent’, ‘present’]</li>
</ul>
</div>
<div class="section" id="syslog-certificate">
<h3>syslog_certificate<a class="headerlink" href="#syslog-certificate" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: Certificate used to communicate with Syslog server if encryption on.</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="syslog-enc-algorithm">
<h3>syslog_enc_algorithm<a class="headerlink" href="#syslog-enc-algorithm" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Description: Enable/disable reliable syslogging with TLS encryption.</p>
<p>choice | high | SSL communication with high encryption algorithms.</p>
<p>choice | low | SSL communication with low encryption algorithms.</p>
<p>choice | disable | Disable SSL communication.</p>
<p>choice | high-medium | SSL communication with high and medium encryption algorithms.</p>
</li>
<li><p class="first">Required: False</p>
</li>
<li><p class="first">default: disable</p>
</li>
<li><p class="first">choices: [‘high’, ‘low’, ‘disable’, ‘high-medium’]</p>
</li>
</ul>
</div>
<div class="section" id="syslog-facility">
<h3>syslog_facility<a class="headerlink" href="#syslog-facility" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Description: Remote syslog facility.</p>
<p>choice | kernel | Kernel messages.</p>
<p>choice | user | Random user-level messages.</p>
<p>choice | mail | Mail system.</p>
<p>choice | daemon | System daemons.</p>
<p>choice | auth | Security/authorization messages.</p>
<p>choice | syslog | Messages generated internally by syslog.</p>
<p>choice | lpr | Line printer subsystem.</p>
<p>choice | news | Network news subsystem.</p>
<p>choice | uucp | Network news subsystem.</p>
<p>choice | cron | Clock daemon.</p>
<p>choice | authpriv | Security/authorization messages (private).</p>
<p>choice | ftp | FTP daemon.</p>
<p>choice | ntp | NTP daemon.</p>
<p>choice | audit | Log audit.</p>
<p>choice | alert | Log alert.</p>
<p>choice | clock | Clock daemon.</p>
<p>choice | local0 | Reserved for local use.</p>
<p>choice | local1 | Reserved for local use.</p>
<p>choice | local2 | Reserved for local use.</p>
<p>choice | local3 | Reserved for local use.</p>
<p>choice | local4 | Reserved for local use.</p>
<p>choice | local5 | Reserved for local use.</p>
<p>choice | local6 | Reserved for local use.</p>
<p>choice | local7 | Reserved for local use.</p>
</li>
<li><p class="first">Required: False</p>
</li>
<li><p class="first">default: syslog</p>
</li>
<li><p class="first">choices: [‘kernel’, ‘user’, ‘mail’, ‘daemon’, ‘auth’, ‘syslog’, ‘lpr’, ‘news’, ‘uucp’, ‘cron’, ‘authpriv’, ‘ftp’, ‘ntp’, ‘audit’, ‘alert’, ‘clock’, ‘local0’, ‘local1’, ‘local2’, ‘local3’, ‘local4’, ‘local5’, ‘local6’, ‘local7’]</p>
</li>
</ul>
</div>
<div class="section" id="syslog-filter">
<h3>syslog_filter<a class="headerlink" href="#syslog-filter" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: sets the logging level for syslog</li>
<li>Required: False</li>
<li>choices: [‘emergency’, ‘alert’, ‘critical’, ‘error’, ‘warning’, ‘notification’, ‘information’, ‘debug’]</li>
</ul>
</div>
<div class="section" id="syslog-mode">
<h3>syslog_mode<a class="headerlink" href="#syslog-mode" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Description: Remote syslog logging over UDP/Reliable TCP.</p>
<p>choice | udp | Enable syslogging over UDP.</p>
<p>choice | legacy-reliable | Enable legacy reliable syslogging by RFC3195 (Reliable Delivery for Syslog).</p>
<p>choice | reliable | Enable reliable syslogging by RFC6587 (Transmission of Syslog Messages over TCP).</p>
</li>
<li><p class="first">Required: False</p>
</li>
<li><p class="first">default: udp</p>
</li>
<li><p class="first">choices: [‘udp’, ‘legacy-reliable’, ‘reliable’]</p>
</li>
</ul>
</div>
<div class="section" id="syslog-port">
<h3>syslog_port<a class="headerlink" href="#syslog-port" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: syslog port that will be set</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="syslog-server">
<h3>syslog_server<a class="headerlink" href="#syslog-server" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: server the syslogs will be sent to</li>
<li>Required: False</li>
</ul>
</div>
<div class="section" id="syslog-status">
<h3>syslog_status<a class="headerlink" href="#syslog-status" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: enables or disables syslogs</li>
<li>Required: False</li>
<li>choices: [‘enable’, ‘disable’]</li>
</ul>
</div>
<div class="section" id="username">
<h3>username<a class="headerlink" href="#username" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Description: The username used to authenticate with the FortiManager.</li>
<li>Required: False</li>
</ul>
</div>
</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>get_devprof</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_devprof</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    GET the DevProf (check to see if exists)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># &quot;name&quot;: paramgram[&quot;provisioning_template&quot;]</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/devprof/adom/{adom}/{name}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>del_devprof</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">del_devprof</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DELETE the DevProf</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># &quot;name&quot;: paramgram[&quot;delete_provisioning_template&quot;]</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/devprof/adom/{adom}/{name}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                                  <span class="n">name</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;delete_provisioning_template&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>add_devprof</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add_devprof</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    GET the DevProf (check to see if exists)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">],</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;devprof&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;CreatedByAnsible&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/devprof/adom/{adom}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>get_devprof_scope</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_devprof_scope</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    GETS a device provisioning template and its scope</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">],</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;devprof&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;CreatedByAnsible&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/devprof/adom/{adom}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>set_devprof_scope</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_devprof_scope</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SETS a device provisioning template and its scope</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">],</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;devprof&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;CreatedByAnsible&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">targets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provision_targets&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
        <span class="c1"># split the host on the space to get the mask out</span>
        <span class="n">new_target</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">}</span>
        <span class="n">targets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_target</span><span class="p">)</span>

    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;scope member&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">targets</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/devprof/adom/{adom}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>delete_devprof_scope</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">delete_devprof_scope</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DELETES the Current Scope for ProvTemplate</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">],</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;devprof&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;CreatedByAnsible&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scope member&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;targets_to_add&quot;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/devprof/adom/{adom}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>set_devprof_snmp</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_devprof_snmp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ENABLE SNMP ON DevProf</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_status&quot;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}/devprof/&quot;</span> \
          <span class="s2">&quot;{provisioning_template}/system/snmp/sysinfo&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                                               <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>delete_devprof_snmp</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">delete_devprof_snmp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DISABLE SNMP on Provision Template</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_status&quot;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}/devprof/&quot;</span> \
          <span class="s2">&quot;{provisioning_template}/system/snmp/sysinfo&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                                               <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>set_devprof_snmp_v2c</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_devprof_snmp_v2c</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ENABLE SNMP ON DevProf</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;query-v2c-port&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_query_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;trap-v2c-rport&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;trap-v2c-status&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;query-v2c-status&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_query_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_name&quot;</span><span class="p">],</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_id&quot;</span><span class="p">],</span>
        <span class="s2">&quot;meta fields&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(),</span>
        <span class="s2">&quot;hosts&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(),</span>
        <span class="s2">&quot;events&quot;</span><span class="p">:</span> <span class="mi">411578417151</span><span class="p">,</span>
        <span class="s2">&quot;query-v1-status&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;query-v1-port&quot;</span><span class="p">:</span> <span class="mi">161</span><span class="p">,</span>
        <span class="s2">&quot;trap-v1-status&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;trap-v1-lport&quot;</span><span class="p">:</span> <span class="mi">162</span><span class="p">,</span>
        <span class="s2">&quot;trap-v1-rport&quot;</span><span class="p">:</span> <span class="mi">162</span><span class="p">,</span>
        <span class="s2">&quot;trap-v2c-lport&quot;</span><span class="p">:</span> <span class="mi">162</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># BUILD THE HOST STRINGS</span>
    <span class="n">id_counter</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_hosts_ipv4&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_query_hosts_ipv4&quot;</span><span class="p">]:</span>
        <span class="n">hosts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_query_hosts_ipv4&quot;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">ipv4_host</span> <span class="ow">in</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_query_hosts_ipv4&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
                <span class="c1"># split the host on the space to get the mask out</span>
                <span class="n">new_ipv4_host</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ha-direct&quot;</span><span class="p">:</span> <span class="s2">&quot;enable&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;host-type&quot;</span><span class="p">:</span> <span class="s2">&quot;query&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">id_counter</span><span class="p">,</span>
                                 <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="n">ipv4_host</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
                                 <span class="s2">&quot;meta fields&quot;</span><span class="p">:</span> <span class="p">{},</span>
                                 <span class="s2">&quot;source-ip&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0.0.0&quot;</span><span class="p">}</span>
                <span class="n">hosts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_ipv4_host</span><span class="p">)</span>
                <span class="n">id_counter</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_hosts_ipv4&quot;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">ipv4_host</span> <span class="ow">in</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_hosts_ipv4&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
                <span class="c1"># split the host on the space to get the mask out</span>
                <span class="n">new_ipv4_host</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ha-direct&quot;</span><span class="p">:</span> <span class="s2">&quot;enable&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;host-type&quot;</span><span class="p">:</span> <span class="s2">&quot;trap&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">id_counter</span><span class="p">,</span>
                                 <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="n">ipv4_host</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
                                 <span class="s2">&quot;meta fields&quot;</span><span class="p">:</span> <span class="p">{},</span>
                                 <span class="s2">&quot;source-ip&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_src_ipv4&quot;</span><span class="p">]}</span>
                <span class="n">hosts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_ipv4_host</span><span class="p">)</span>
                <span class="n">id_counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;hosts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hosts</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}/devprof/&quot;</span> \
          <span class="s2">&quot;{provisioning_template}/system/snmp/community&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                                                 <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span>
                                                                     <span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>delete_devprof_snmp_v2c</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">delete_devprof_snmp_v2c</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DISABLE SNMP on Provision Template</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;confirm&quot;</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}/&quot;</span> \
          <span class="s2">&quot;devprof/{provisioning_template}/&quot;</span> \
          <span class="s2">&quot;system/snmp/community/{snmp_v2c_id}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                                       <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">],</span>
                                                       <span class="n">snmp_v2c_id</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_id&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>set_devprof_snmp_v3</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_devprof_snmp_v3</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ENABLE SNMP ON DevProf</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="c1"># transform options</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_trap_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;trap-status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_trap_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;disable&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;trap-status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_queries&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;queries&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_queries&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;disable&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;queries&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;disable&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_auth_proto&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;md5&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;auth-proto&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_auth_proto&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;sha&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;auth-proto&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_priv_proto&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;aes&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;auth-proto&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_priv_proto&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;des&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;priv-proto&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_priv_proto&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;aes256&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;priv-proto&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_priv_proto&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;aes256cisco&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;priv-proto&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_security_level&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;no-auth-no-priv&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;security-level&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_security_level&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;auth-no-priv&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;security-level&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_security_level&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;auth-priv&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;security-level&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;auth-pwd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_auth_pwd&quot;</span><span class="p">]</span>
    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;priv-pwd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_priv_pwd&quot;</span><span class="p">]</span>
    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;trap-rport&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_trap_rport&quot;</span><span class="p">]</span>
    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;query-port&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_query_port&quot;</span><span class="p">]</span>
    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_name&quot;</span><span class="p">]</span>
    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;notify-hosts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_notify_hosts&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;events&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1647387997183</span>
    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;trap-lport&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">162</span>

    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;source-ip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_source_ip&quot;</span><span class="p">]</span>
    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ha-direct&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}/&quot;</span> \
          <span class="s2">&quot;devprof/{provisioning_template}/&quot;</span> \
          <span class="s2">&quot;system/snmp/user&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                    <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>delete_devprof_snmp_v3</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">delete_devprof_snmp_v3</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DISABLE SNMP on Provision Template</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;confirm&quot;</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}/devprof/&quot;</span> \
          <span class="s2">&quot;{provisioning_template}/system/snmp&quot;</span> \
          <span class="s2">&quot;/user/{snmpv3_name}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                       <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">],</span>
                                       <span class="n">snmpv3_name</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_name&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>set_devprof_syslog</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_devprof_syslog</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the SYSLOG SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;server&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_server&quot;</span><span class="p">],</span>
        <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_mode&quot;</span><span class="p">],</span>
        <span class="s2">&quot;facility&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_facility&quot;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_enc_algorithm&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">,</span> <span class="s2">&quot;high-medium&quot;</span><span class="p">]</span> \
            <span class="ow">and</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_certificate&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;certificate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;certificate&quot;</span><span class="p">]</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;enc-algorithm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_enc_algorithm&quot;</span><span class="p">]</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}/&quot;</span> \
          <span class="s2">&quot;devprof/{provisioning_template}/&quot;</span> \
          <span class="s2">&quot;log/syslogd/setting&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                       <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>delete_devprof_syslog</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">delete_devprof_syslog</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DISABLE SYSLOG SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;server&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_server&quot;</span><span class="p">],</span>
        <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_mode&quot;</span><span class="p">],</span>
        <span class="s2">&quot;facility&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_facility&quot;</span><span class="p">]</span>
    <span class="p">}</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}/&quot;</span> \
          <span class="s2">&quot;devprof/{provisioning_template}/&quot;</span> \
          <span class="s2">&quot;log/syslogd/setting&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                       <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>set_devprof_syslog_filter</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_devprof_syslog_filter</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the SYSLOG SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_filter&quot;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/log/syslogd/filter&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                       <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>delete_devprof_syslog_filter</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">delete_devprof_syslog_filter</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DISABLE SYSLOG SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_filter&quot;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/log/syslogd/filter&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                       <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>set_devprof_ntp</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_devprof_ntp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the NTP SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;msg&quot;</span><span class="p">:</span> <span class="s2">&quot;Illegal or malformed paramgram discovered. System Exception&quot;</span><span class="p">})</span>
    <span class="c1"># IF SET TO FORTIGUARD, BUILD A STRING SPECIFIC TO THAT</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;fortiguard&quot;</span><span class="p">:</span>
        <span class="n">datagram</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ntpsync&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;disable&quot;</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ntpsync&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_sync_interval&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;syncinterval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;syncinterval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_sync_interval&quot;</span><span class="p">]</span>

        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># IF THE NTP TYPE IS CUSTOM BUILD THE SERVER LIST</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;custom&quot;</span><span class="p">:</span>
        <span class="n">id_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">key_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ntpservers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">datagram</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ntpsync&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;disable&quot;</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ntpsync&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;syncinterval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_sync_interval&quot;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;syncinterval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_server&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
            <span class="n">id_counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">server_fields</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

            <span class="n">key_counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_auth&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;authentication&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_auth_pwd&quot;</span><span class="p">]</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;key-id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_counter</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;authentication&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;key-id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_counter</span>

            <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_v3&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;ntp_v3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;ntp_v3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># split the host on the space to get the mask out</span>
            <span class="n">new_ntp_server</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;authentication&quot;</span><span class="p">:</span> <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;authentication&quot;</span><span class="p">],</span>
                              <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">id_counter</span><span class="p">,</span> <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span>
                              <span class="s2">&quot;key-id&quot;</span><span class="p">:</span> <span class="n">id_counter</span><span class="p">,</span> <span class="s2">&quot;ntpv3&quot;</span><span class="p">:</span> <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;ntp_v3&quot;</span><span class="p">],</span>
                              <span class="s2">&quot;server&quot;</span><span class="p">:</span> <span class="n">server</span><span class="p">}</span>
            <span class="n">ntpservers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_ntp_server</span><span class="p">)</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ntpserver&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ntpservers</span>

    <span class="c1"># SET THE BODY FOR THE FORTIGUARD REQUEST</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/system/ntp&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                               <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>delete_devprof_ntp</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">delete_devprof_ntp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DISABLE NTP SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;msg&quot;</span><span class="p">:</span> <span class="s2">&quot;Illegal or malformed paramgram discovered. System Exception&quot;</span><span class="p">})</span>
    <span class="c1"># IF SET TO FORTIGUARD, BUILD A STRING SPECIFIC TO THAT</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;fortiguard&quot;</span><span class="p">:</span>
        <span class="n">datagram</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ntpsync&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;disable&quot;</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ntpsync&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_sync_interval&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;syncinterval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;syncinterval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_sync_interval&quot;</span><span class="p">]</span>

        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># IF THE NTP TYPE IS CUSTOM BUILD THE SERVER LIST</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;custom&quot;</span><span class="p">:</span>
        <span class="n">id_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">key_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ntpservers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">datagram</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ntpsync&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;disable&quot;</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ntpsync&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_sync_interval&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;syncinterval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;syncinterval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_sync_interval&quot;</span><span class="p">]</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_server&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
            <span class="n">id_counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">server_fields</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

            <span class="n">key_counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_auth&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;authentication&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_auth_pwd&quot;</span><span class="p">]</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;key-id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_counter</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;authentication&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;key-id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_counter</span>

            <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_v3&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;ntpv3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;ntpv3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># split the host on the space to get the mask out</span>
            <span class="n">new_ntp_server</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;authentication&quot;</span><span class="p">:</span> <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;authentication&quot;</span><span class="p">],</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">id_counter</span><span class="p">,</span>
                              <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span> <span class="s2">&quot;key-id&quot;</span><span class="p">:</span> <span class="n">id_counter</span><span class="p">,</span> <span class="s2">&quot;ntpv3&quot;</span><span class="p">:</span> <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;ntpv3&quot;</span><span class="p">],</span>
                              <span class="s2">&quot;server&quot;</span><span class="p">:</span> <span class="n">server</span><span class="p">}</span>
            <span class="n">ntpservers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_ntp_server</span><span class="p">)</span>

        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ntpserver&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ntpservers</span>

    <span class="c1"># SET THE BODY FOR THE FORTIGUARD REQUEST</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/system/ntp&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                               <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>set_devprof_admin</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_devprof_admin</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        DISABLE NTP SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;admin-https-redirect&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_https_redirect&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin-port&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_http_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin-sport&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_https_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admintimeout&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_timeout&quot;</span><span class="p">],</span>
        <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_language&quot;</span><span class="p">],</span>
        <span class="s2">&quot;gui-theme&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_gui_theme&quot;</span><span class="p">],</span>
        <span class="s2">&quot;switch-controller&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_switch_controller&quot;</span><span class="p">],</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/system/global&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                  <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>delete_devprof_admin</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">delete_devprof_admin</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        CHANGE ADMIN SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;admin-https-redirect&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_https_redirect&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin-port&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_http_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin-sport&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_https_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admintimeout&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_timeout&quot;</span><span class="p">],</span>
        <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_language&quot;</span><span class="p">],</span>
        <span class="s2">&quot;gui-theme&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_gui_theme&quot;</span><span class="p">],</span>
        <span class="s2">&quot;switch-controller&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_switch_controller&quot;</span><span class="p">],</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/system/global&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                  <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>set_devprof_smtp</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_devprof_smtp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       ENABLE SMTP SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;reply-to&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_replyto&quot;</span><span class="p">],</span>
        <span class="s2">&quot;server&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_server&quot;</span><span class="p">],</span>
        <span class="s2">&quot;source-ip&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_source_ipv4&quot;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_username&quot;</span><span class="p">]:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;authenticate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;username&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_username&quot;</span><span class="p">]</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_password&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_conn_sec&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_conn_sec&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;starttls&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_conn_sec&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;smtps&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_validate_cert&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;validate-server&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;validate-server&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/system/email-server&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                        <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>delete_devprof_smtp</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">delete_devprof_smtp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        DISABLE SMTP SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;reply-to&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_replyto&quot;</span><span class="p">],</span>
        <span class="s2">&quot;server&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_server&quot;</span><span class="p">],</span>
        <span class="s2">&quot;source-ip&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_source_ipv4&quot;</span><span class="p">],</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_username&quot;</span><span class="p">]:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;authenticate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;username&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_username&quot;</span><span class="p">]</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_password&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_conn_sec&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_conn_sec&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;starttls&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_conn_sec&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;smtps&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_validate_cert&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;validate-server&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;validate-server&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/system/email-server&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                        <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>set_devprof_dns</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_devprof_dns</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       ENABLE DNS SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;domain&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;dns_suffix&quot;</span><span class="p">],</span>
        <span class="s2">&quot;primary&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;dns_primary_ipv4&quot;</span><span class="p">],</span>
        <span class="s2">&quot;secondary&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;dns_secondary_ipv4&quot;</span><span class="p">],</span>
    <span class="p">}</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/system/dns&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                               <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>delete_devprof_dns</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">delete_devprof_dns</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        DISABLE DNS SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;domain&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;dns_suffix&quot;</span><span class="p">],</span>
        <span class="s2">&quot;primary&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;dns_primary_ipv4&quot;</span><span class="p">],</span>
        <span class="s2">&quot;secondary&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;dns_secondary_ipv4&quot;</span><span class="p">],</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/system/dns&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                               <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>set_devprof_toggle_fg</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_devprof_toggle_fg</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       TOGGLE FG SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pydevd.settrace(&#39;10.0.0.122&#39;, port=54654, stdoutToServer=True, stderrToServer=True)</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_enable_fortiguard&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;direct&quot;</span><span class="p">,</span> <span class="s2">&quot;this-fmg&quot;</span><span class="p">]:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;include-default-servers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;enable&quot;</span>
    <span class="k">elif</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_enable_fortiguard&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;include-default-servers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;disable&quot;</span>

    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;server-list&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/system/central-management&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                              <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>set_devprof_fg</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_devprof_fg</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       ENABLE FG SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pydevd.settrace(&#39;10.0.0.122&#39;, port=54654, stdoutToServer=True, stderrToServer=True)</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_enable_fortiguard&quot;</span><span class="p">],</span>
        <span class="s2">&quot;target-ip&quot;</span><span class="p">:</span> <span class="bp">None</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_fortiguard_target&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;direct&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;target-ip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_fortiguard_target&quot;</span><span class="p">]</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/device/profile/fortiguard&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                              <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>delete_devprof_fg</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">delete_devprof_fg</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        DISABLE FG SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_enable_fortiguard&quot;</span><span class="p">],</span>
        <span class="s2">&quot;target-ip&quot;</span><span class="p">:</span> <span class="bp">None</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/device/profile/fortiguard&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                              <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>set_devprof_faz</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_devprof_faz</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       ENABLE FAZ SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;target-ip&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_fortianalyzer_target&quot;</span><span class="p">],</span>
        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/device/profile/fortianalyzer&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                                 <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>delete_devprof_faz</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">delete_devprof_faz</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        DISABLE FAZ SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;target-ip&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_fortianalyzer_target&quot;</span><span class="p">],</span>
        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="s2">&quot;hastarget&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/device/profile/fortianalyzer&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                                 <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>fmgr_logout</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;NULL&quot;</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="p">(),</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="n">logout_on_fail</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">logout_on_success</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    THIS METHOD CONTROLS THE LOGOUT AND ERROR REPORTING AFTER AN METHOD OR FUNCTION RUNS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># VALIDATION ERROR (NO RESULTS, JUST AN EXIT)</span>
    <span class="k">if</span> <span class="n">msg</span> <span class="o">!=</span> <span class="s2">&quot;NULL&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fmg</span><span class="o">.</span><span class="n">logout</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">module</span><span class="o">.</span><span class="n">fail_json</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># SUBMISSION ERROR</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">msg</span> <span class="o">==</span> <span class="s2">&quot;NULL&quot;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;status&#39;</span><span class="p">][</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;No status message returned from pyFMG. Possible that this was a GET with a tuple result.&quot;</span>

        <span class="k">if</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">good_codes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">logout_on_fail</span><span class="p">:</span>
                <span class="n">fmg</span><span class="o">.</span><span class="n">logout</span><span class="p">()</span>
                <span class="n">module</span><span class="o">.</span><span class="n">fail_json</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="o">**</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">logout_on_success</span><span class="p">:</span>
                <span class="n">fmg</span><span class="o">.</span><span class="n">logout</span><span class="p">()</span>
                <span class="n">module</span><span class="o">.</span><span class="n">exit_json</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s2">&quot;API Called worked, but logout handler has been asked to logout on success&quot;</span><span class="p">,</span>
                                 <span class="o">**</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">msg</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>main</li>
</ul>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">argument_spec</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">adom</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">host</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">username</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fallback</span><span class="o">=</span><span class="p">(</span><span class="n">env_fallback</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;ANSIBLE_NET_USERNAME&quot;</span><span class="p">])),</span>
        <span class="n">password</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fallback</span><span class="o">=</span><span class="p">(</span><span class="n">env_fallback</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;ANSIBLE_NET_PASSWORD&quot;</span><span class="p">]),</span> <span class="n">no_log</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
        <span class="n">state</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;present&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;absent&quot;</span><span class="p">,</span> <span class="s2">&quot;present&quot;</span><span class="p">]),</span>

        <span class="n">provisioning_template</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">provision_targets</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>

        <span class="n">device_unique_name</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">snmp_status</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">snmp_v2c_query_port</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">snmp_v2c_trap_port</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">snmp_v2c_status</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">snmp_v2c_trap_status</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">snmp_v2c_query_status</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">snmp_v2c_name</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">no_log</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
        <span class="n">snmp_v2c_id</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">snmp_v2c_trap_src_ipv4</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">snmp_v2c_trap_hosts_ipv4</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">snmp_v2c_query_hosts_ipv4</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>

        <span class="n">snmpv3_auth_proto</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;md5&quot;</span><span class="p">,</span> <span class="s2">&quot;sha&quot;</span><span class="p">]),</span>
        <span class="n">snmpv3_auth_pwd</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">no_log</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
        <span class="n">snmpv3_name</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">snmpv3_notify_hosts</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">snmpv3_priv_proto</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;aes&quot;</span><span class="p">,</span> <span class="s2">&quot;des&quot;</span><span class="p">,</span> <span class="s2">&quot;aes256&quot;</span><span class="p">,</span> <span class="s2">&quot;aes256cisco&quot;</span><span class="p">]),</span>
        <span class="n">snmpv3_priv_pwd</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">no_log</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
        <span class="n">snmpv3_queries</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">snmpv3_query_port</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">snmpv3_security_level</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>
                                   <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;no-auth-no-priv&quot;</span><span class="p">,</span> <span class="s2">&quot;auth-no-priv&quot;</span><span class="p">,</span> <span class="s2">&quot;auth-priv&quot;</span><span class="p">]),</span>
        <span class="n">snmpv3_source_ip</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">snmpv3_status</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">snmpv3_trap_rport</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">snmpv3_trap_status</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>

        <span class="n">syslog_port</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">syslog_server</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">syslog_mode</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;udp&quot;</span><span class="p">,</span> <span class="s2">&quot;legacy-reliable&quot;</span><span class="p">,</span> <span class="s2">&quot;reliable&quot;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;udp&quot;</span><span class="p">),</span>
        <span class="n">syslog_status</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">syslog_filter</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;emergency&quot;</span><span class="p">,</span> <span class="s2">&quot;alert&quot;</span><span class="p">,</span> <span class="s2">&quot;critical&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
                                                                <span class="s2">&quot;warning&quot;</span><span class="p">,</span> <span class="s2">&quot;notification&quot;</span><span class="p">,</span> <span class="s2">&quot;information&quot;</span><span class="p">,</span> <span class="s2">&quot;debug&quot;</span><span class="p">]),</span>
        <span class="n">syslog_enc_algorithm</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">,</span> <span class="s2">&quot;high-medium&quot;</span><span class="p">],</span>
                                  <span class="n">default</span><span class="o">=</span><span class="s2">&quot;disable&quot;</span><span class="p">),</span>
        <span class="n">syslog_facility</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;kernel&quot;</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;mail&quot;</span><span class="p">,</span> <span class="s2">&quot;daemon&quot;</span><span class="p">,</span> <span class="s2">&quot;auth&quot;</span><span class="p">,</span>
                                                                  <span class="s2">&quot;syslog&quot;</span><span class="p">,</span> <span class="s2">&quot;lpr&quot;</span><span class="p">,</span> <span class="s2">&quot;news&quot;</span><span class="p">,</span> <span class="s2">&quot;uucp&quot;</span><span class="p">,</span> <span class="s2">&quot;cron&quot;</span><span class="p">,</span> <span class="s2">&quot;authpriv&quot;</span><span class="p">,</span>
                                                                  <span class="s2">&quot;ftp&quot;</span><span class="p">,</span> <span class="s2">&quot;ntp&quot;</span><span class="p">,</span> <span class="s2">&quot;audit&quot;</span><span class="p">,</span> <span class="s2">&quot;alert&quot;</span><span class="p">,</span> <span class="s2">&quot;clock&quot;</span><span class="p">,</span> <span class="s2">&quot;local0&quot;</span><span class="p">,</span>
                                                                  <span class="s2">&quot;local1&quot;</span><span class="p">,</span> <span class="s2">&quot;local2&quot;</span><span class="p">,</span> <span class="s2">&quot;local3&quot;</span><span class="p">,</span> <span class="s2">&quot;local4&quot;</span><span class="p">,</span> <span class="s2">&quot;local5&quot;</span><span class="p">,</span>
                                                                  <span class="s2">&quot;local6&quot;</span><span class="p">,</span> <span class="s2">&quot;local7&quot;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;syslog&quot;</span><span class="p">),</span>
        <span class="n">syslog_certificate</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>

        <span class="n">ntp_status</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">ntp_sync_interval</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">ntp_type</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fortiguard&quot;</span><span class="p">,</span> <span class="s2">&quot;custom&quot;</span><span class="p">]),</span>
        <span class="n">ntp_server</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">ntp_auth</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">ntp_auth_pwd</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">no_log</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
        <span class="n">ntp_v3</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>

        <span class="n">admin_https_redirect</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">admin_https_port</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">admin_http_port</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">admin_timeout</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">admin_language</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>
                            <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;english&quot;</span><span class="p">,</span> <span class="s2">&quot;simch&quot;</span><span class="p">,</span> <span class="s2">&quot;japanese&quot;</span><span class="p">,</span> <span class="s2">&quot;korean&quot;</span><span class="p">,</span>
                                     <span class="s2">&quot;spanish&quot;</span><span class="p">,</span> <span class="s2">&quot;trach&quot;</span><span class="p">,</span> <span class="s2">&quot;french&quot;</span><span class="p">,</span> <span class="s2">&quot;portuguese&quot;</span><span class="p">]),</span>
        <span class="n">admin_switch_controller</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">admin_gui_theme</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;melongene&quot;</span><span class="p">,</span> <span class="s2">&quot;mariner&quot;</span><span class="p">]),</span>
        <span class="n">admin_enable_fortiguard</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="s2">&quot;direct&quot;</span><span class="p">,</span> <span class="s2">&quot;this-fmg&quot;</span><span class="p">]),</span>
        <span class="n">admin_fortianalyzer_target</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">admin_fortiguard_target</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>

        <span class="n">smtp_username</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">smtp_password</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">no_log</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
        <span class="n">smtp_port</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">smtp_replyto</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">smtp_conn_sec</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="s2">&quot;starttls&quot;</span><span class="p">,</span> <span class="s2">&quot;smtps&quot;</span><span class="p">]),</span>
        <span class="n">smtp_server</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">smtp_source_ipv4</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">smtp_validate_cert</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>

        <span class="n">dns_suffix</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">dns_primary_ipv4</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">dns_secondary_ipv4</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">delete_provisioning_template</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">)</span>

    <span class="p">)</span>

    <span class="n">module</span> <span class="o">=</span> <span class="n">AnsibleModule</span><span class="p">(</span><span class="n">argument_spec</span><span class="p">,</span> <span class="n">supports_check_mode</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="p">)</span>

    <span class="n">paramgram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;adom&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
        <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">],</span>
        <span class="s2">&quot;provision_targets&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;provision_targets&quot;</span><span class="p">],</span>
        <span class="s2">&quot;provisioning_template&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">],</span>

        <span class="s2">&quot;snmp_status&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmp_v2c_query_port&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_query_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmp_v2c_trap_port&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmp_v2c_status&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmp_v2c_trap_status&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmp_v2c_query_status&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_query_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmp_v2c_name&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_name&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmp_v2c_id&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_id&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmp_v2c_trap_src_ipv4&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_src_ipv4&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmp_v2c_trap_hosts_ipv4&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_hosts_ipv4&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmp_v2c_query_hosts_ipv4&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_query_hosts_ipv4&quot;</span><span class="p">],</span>

        <span class="s2">&quot;snmpv3_auth_proto&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_auth_proto&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_auth_pwd&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_auth_pwd&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_name&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_name&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_notify_hosts&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_notify_hosts&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_priv_proto&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_priv_proto&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_priv_pwd&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_priv_pwd&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_queries&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_queries&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_query_port&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_query_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_security_level&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_security_level&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_source_ip&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_source_ip&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_status&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_trap_rport&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_trap_rport&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_trap_status&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_trap_status&quot;</span><span class="p">],</span>

        <span class="s2">&quot;syslog_port&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;syslog_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;syslog_server&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;syslog_server&quot;</span><span class="p">],</span>
        <span class="s2">&quot;syslog_mode&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;syslog_mode&quot;</span><span class="p">],</span>
        <span class="s2">&quot;syslog_status&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;syslog_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;syslog_filter&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;syslog_filter&quot;</span><span class="p">],</span>
        <span class="s2">&quot;syslog_facility&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;syslog_facility&quot;</span><span class="p">],</span>
        <span class="s2">&quot;syslog_enc_algorithm&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;syslog_enc_algorithm&quot;</span><span class="p">],</span>
        <span class="s2">&quot;syslog_certificate&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;syslog_certificate&quot;</span><span class="p">],</span>

        <span class="s2">&quot;ntp_status&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;ntp_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;ntp_sync_interval&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;ntp_sync_interval&quot;</span><span class="p">],</span>
        <span class="s2">&quot;ntp_type&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;ntp_type&quot;</span><span class="p">],</span>
        <span class="s2">&quot;ntp_server&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;ntp_server&quot;</span><span class="p">],</span>
        <span class="s2">&quot;ntp_auth&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;ntp_auth&quot;</span><span class="p">],</span>
        <span class="s2">&quot;ntp_auth_pwd&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;ntp_auth_pwd&quot;</span><span class="p">],</span>
        <span class="s2">&quot;ntp_v3&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;ntp_v3&quot;</span><span class="p">],</span>

        <span class="s2">&quot;admin_https_redirect&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;admin_https_redirect&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin_https_port&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;admin_https_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin_http_port&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;admin_http_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin_timeout&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;admin_timeout&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin_language&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;admin_language&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin_switch_controller&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;admin_switch_controller&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin_gui_theme&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;admin_gui_theme&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin_enable_fortiguard&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;admin_enable_fortiguard&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin_fortianalyzer_target&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;admin_fortianalyzer_target&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin_fortiguard_target&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;admin_fortiguard_target&quot;</span><span class="p">],</span>

        <span class="s2">&quot;smtp_username&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;smtp_username&quot;</span><span class="p">],</span>
        <span class="s2">&quot;smtp_password&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;smtp_password&quot;</span><span class="p">],</span>
        <span class="s2">&quot;smtp_port&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;smtp_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;smtp_replyto&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;smtp_replyto&quot;</span><span class="p">],</span>
        <span class="s2">&quot;smtp_conn_sec&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;smtp_conn_sec&quot;</span><span class="p">],</span>
        <span class="s2">&quot;smtp_server&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;smtp_server&quot;</span><span class="p">],</span>
        <span class="s2">&quot;smtp_source_ipv4&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;smtp_source_ipv4&quot;</span><span class="p">],</span>
        <span class="s2">&quot;smtp_validate_cert&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;smtp_validate_cert&quot;</span><span class="p">],</span>

        <span class="s2">&quot;dns_suffix&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;dns_suffix&quot;</span><span class="p">],</span>
        <span class="s2">&quot;dns_primary_ipv4&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;dns_primary_ipv4&quot;</span><span class="p">],</span>
        <span class="s2">&quot;dns_secondary_ipv4&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;dns_secondary_ipv4&quot;</span><span class="p">],</span>
        <span class="s2">&quot;delete_provisioning_template&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;delete_provisioning_template&quot;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="c1"># validate required arguments are passed; not used in argument_spec to allow params to be called from provider</span>
    <span class="c1"># check if params are set</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;msg&quot;</span><span class="p">:</span> <span class="s2">&quot;Illegal or malformed paramgram discovered. System Exception&quot;</span><span class="p">})</span>
    <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;host&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;username&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">module</span><span class="o">.</span><span class="n">fail_json</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Host and username are required for connection&quot;</span><span class="p">)</span>

    <span class="c1"># CHECK IF LOGIN FAILED</span>
    <span class="n">fmg</span> <span class="o">=</span> <span class="n">AnsibleFortiManager</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;host&quot;</span><span class="p">],</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;username&quot;</span><span class="p">],</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">login</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">response</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;status&#39;</span><span class="p">][</span><span class="s1">&#39;code&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">module</span><span class="o">.</span><span class="n">fail_json</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Connection to FortiManager Failed&quot;</span><span class="p">)</span>

    <span class="c1"># START SESSION LOGIC</span>
    <span class="c1"># CHECK IF WE ARE DELETING AN ENTIRE TEMPLATE. IF THAT&#39;S THE CASE DO IT FIRST AND IGNORE THE REST.</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;delete_provisioning_template&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">del_devprof</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
        <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete provisioning template&quot;</span><span class="p">,</span> <span class="n">logout_on_success</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="c1"># CHECK TO SEE IF THE DEVPROF TEMPLATE EXISTS</span>
    <span class="n">devprof</span> <span class="o">=</span> <span class="n">get_devprof</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">devprof</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">add_devprof</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
        <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>

    <span class="c1"># PROCESS THE SNMP SETTINGS IF THE SNMP_STATUS VARIABLE IS SET</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_status&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="c1"># enable SNMP in the devprof template</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_snmp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="c1"># disable SNMP in the devprof template</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_snmp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete SNMP status&quot;</span><span class="p">)</span>

    <span class="c1"># PROCESS THE SNMP V2C COMMUNITY SETTINGS IF THEY ARE ALL HERE</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">(</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_query_port&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_port&quot;</span><span class="p">],</span>
                                   <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_status&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_status&quot;</span><span class="p">],</span>
                                   <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_query_status&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_name&quot;</span><span class="p">],</span>
                                   <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_id&quot;</span><span class="p">])):</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_snmp_v2c</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to create SNMP V2C Community&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_snmp_v2c</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete SNMP V2C Community&quot;</span><span class="p">)</span>

    <span class="c1"># PROCESS THE SNMPV3 USER IF THERE</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">(</span>
            <span class="p">[</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_auth_proto&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_auth_pwd&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_name&quot;</span><span class="p">],</span>
             <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_notify_hosts&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_priv_proto&quot;</span><span class="p">],</span>
             <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_priv_pwd&quot;</span><span class="p">],</span>
             <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_queries&quot;</span><span class="p">],</span>
             <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_query_port&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_security_level&quot;</span><span class="p">],</span>
             <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_source_ip&quot;</span><span class="p">],</span>
             <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_status&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_trap_rport&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_trap_status&quot;</span><span class="p">]])):</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_snmp_v3</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to create SNMP V3 Community&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_snmp_v3</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to create SNMP V3 Community&quot;</span><span class="p">)</span>

    <span class="c1"># PROCESS THE SYSLOG SETTINGS IF THE ALL THE NEEDED SYSLOG VARIABLES ARE PRESENT</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_port&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_mode&quot;</span><span class="p">],</span>
                                   <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_server&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_status&quot;</span><span class="p">]]):</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="c1"># enable syslog in the devprof template</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_syslog</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to set Syslog server&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="c1"># disable syslog in the devprof template</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_syslog</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete syslog server settings&quot;</span><span class="p">)</span>

    <span class="c1"># IF THE SYSLOG FILTER IS PRESENT THEN RUN THAT</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_filter&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="c1"># set the syslog filter level</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_syslog_filter</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to set syslog settings&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="c1"># remove the syslog filter level</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_syslog_filter</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete syslog settings&quot;</span><span class="p">)</span>

    <span class="c1"># PROCESS NTP OPTIONS</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_status&quot;</span><span class="p">]:</span>
        <span class="c1"># VALIDATE INPUT</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;custom&quot;</span> <span class="ow">and</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_server&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">module</span><span class="o">.</span><span class="n">exit_json</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s2">&quot;You requested custom NTP type but did not provide ntp_server parameter.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_auth&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span> <span class="ow">and</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_auth_pwd&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">module</span><span class="o">.</span><span class="n">exit_json</span><span class="p">(</span>
                <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;You requested NTP Authentication but did not provide ntp_auth_pwd parameter.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_ntp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to set NTP settings&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_ntp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete NTP settings&quot;</span><span class="p">)</span>

    <span class="c1"># PROCESS THE ADMIN OPTIONS</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">(</span>
            <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_https_redirect&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_https_port&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_http_port&quot;</span><span class="p">],</span>
            <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_timeout&quot;</span><span class="p">],</span>
            <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_language&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_switch_controller&quot;</span><span class="p">],</span>
            <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_gui_theme&quot;</span><span class="p">])):</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_admin</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to set NTP settings&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_admin</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete NTP settings&quot;</span><span class="p">)</span>

    <span class="c1"># PROCESS FORTIGUARD OPTIONS</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_enable_fortiguard&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_toggle_fg</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to toggle Fortiguard on/off&quot;</span><span class="p">)</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_fg</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to set Fortiguard settings&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span> <span class="ow">or</span> <span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">(</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_enable_fortiguard&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_fg</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete Fortiguard settings&quot;</span><span class="p">)</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_toggle_fg</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to toggle Fortiguard on/off&quot;</span><span class="p">)</span>

    <span class="c1"># PROCESS THE SMTP OPTIONS</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">(</span>
            <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_username&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_password&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_port&quot;</span><span class="p">],</span>
            <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_replyto&quot;</span><span class="p">],</span>
            <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_conn_sec&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_server&quot;</span><span class="p">],</span>
            <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_source_ipv4&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_validate_cert&quot;</span><span class="p">])):</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_smtp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to set SMTP settings&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_smtp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete SMTP settings&quot;</span><span class="p">)</span>

    <span class="c1"># PROCESS THE DNS OPTIONS</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span>
           <span class="p">(</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;dns_suffix&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;dns_primary_ipv4&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;dns_secondary_ipv4&quot;</span><span class="p">])):</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_dns</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to set DNS settings&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_dns</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete DNS settings&quot;</span><span class="p">)</span>

    <span class="c1"># PROCESS THE admin_fortianalyzer_target OPTIONS</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_fortianalyzer_target&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_faz</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to set FAZ settings&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_faz</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete FAZ settings&quot;</span><span class="p">)</span>

    <span class="c1"># PROCESS THE PROVISIONING TEMPLATE TARGET PARAMETER</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provision_targets&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_scope</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to set provision targets&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="c1"># WE NEED TO FIGURE OUT WHAT&#39;S THERE FIRST, BEFORE WE CAN RUN THIS</span>
            <span class="n">targets_to_add</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">current_scope</span> <span class="o">=</span> <span class="n">get_devprof_scope</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
                <span class="n">targets_to_remove</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provision_targets&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                <span class="n">targets</span> <span class="o">=</span> <span class="n">current_scope</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;scope member&quot;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">target</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">targets_to_remove</span><span class="p">:</span>
                        <span class="n">target_append</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]}</span>
                        <span class="n">targets_to_add</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">target_append</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;targets_to_add&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">targets_to_add</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_scope</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete provision targets&quot;</span><span class="p">)</span>

    <span class="n">fmg</span><span class="o">.</span><span class="n">logout</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">module</span><span class="o">.</span><span class="n">exit_json</span><span class="p">(</span><span class="o">**</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="module-source-code">
<h2>Module Source Code<a class="headerlink" href="#module-source-code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/python</span>
<span class="c1">#</span>
<span class="c1"># This file is part of Ansible</span>
<span class="c1">#</span>
<span class="c1"># Ansible is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1"># Ansible is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU General Public License</span>
<span class="c1"># along with Ansible.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="c1">#</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>

<span class="vm">__metaclass__</span> <span class="o">=</span> <span class="nb">type</span>

<span class="n">ANSIBLE_METADATA</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;metadata_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;preview&quot;</span><span class="p">],</span>
    <span class="s2">&quot;supported_by&quot;</span><span class="p">:</span> <span class="s2">&quot;community&quot;</span>
<span class="p">}</span>

<span class="n">DOCUMENTATION</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">---</span>
<span class="s1">module: fmgr_device_provision_template</span>
<span class="s1">version_added: &quot;2.8&quot;</span>
<span class="s1">author: Luke Weighall, Andrew Welsh</span>
<span class="s1">short_description: Manages Device Provisioning Templates in FortiManager</span>
<span class="s1">description:</span>
<span class="s1">    - Allows the editing and assignment of device provisioning templates in FortiManager</span>

<span class="s1">options:</span>
<span class="s1">  adom:</span>
<span class="s1">    description:</span>
<span class="s1">     -The ADOM the configuration should belong to.</span>
<span class="s1">    required: true</span>
<span class="s1">  host:</span>
<span class="s1">    description:</span>
<span class="s1">     -The FortiManager&#39;s Address.</span>
<span class="s1">    required: true</span>
<span class="s1">  username:</span>
<span class="s1">    description:</span>
<span class="s1">     -The username used to authenticate with the FortiManager.</span>
<span class="s1">    required: false</span>
<span class="s1">  password:</span>
<span class="s1">    description:</span>
<span class="s1">     -The password associated with the username account.</span>
<span class="s1">    required: false</span>
<span class="s1">  state:</span>
<span class="s1">    description: &gt;</span>
<span class="s1">     -The desired state of the specified object.</span>
<span class="s1">     -absent will delete the object if it exists.</span>
<span class="s1">     -present will create the configuration if needed.</span>
<span class="s1">    required: true</span>
<span class="s1">    default: present</span>
<span class="s1">    choices: [&quot;absent&quot;, &quot;present&quot;]</span>

<span class="s1">  device_unique_name:</span>
<span class="s1">    description:</span>
<span class="s1">     -The unique device&#39;s name that you are editing</span>
<span class="s1">    required: True</span>
<span class="s1">  provisioning_template:</span>
<span class="s1">    description:</span>
<span class="s1">     -The provisioning template you want to apply (default = default)</span>
<span class="s1">    required: True</span>
<span class="s1">  provision_targets:</span>
<span class="s1">    description:</span>
<span class="s1">     -The friendly names of devices in FortiManager to assign the provisioning template to. Comma separated list.</span>
<span class="s1">    required: True</span>
<span class="s1">  snmp_status:</span>
<span class="s1">    description:</span>
<span class="s1">     -enables or disables SNMP globally</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;enable&quot;, &quot;disable&quot;]</span>
<span class="s1">  snmp_v2c_query_port:</span>
<span class="s1">    description:</span>
<span class="s1">     -sets the snmp v2c community query port</span>
<span class="s1">    required: False</span>
<span class="s1">  snmp_v2c_trap_port:</span>
<span class="s1">    description:</span>
<span class="s1">     -sets the snmp v2c community trap port</span>
<span class="s1">    required: False</span>
<span class="s1">  snmp_v2c_status:</span>
<span class="s1">    description:</span>
<span class="s1">     -enables or disables the v2c community specified</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;enable&quot;, &quot;disable&quot;]</span>
<span class="s1">  snmp_v2c_trap_status:</span>
<span class="s1">    description:</span>
<span class="s1">     -enables or disables the v2c community specified for traps</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;enable&quot;, &quot;disable&quot;]</span>
<span class="s1">  snmp_v2c_query_status:</span>
<span class="s1">    description:</span>
<span class="s1">     -enables or disables the v2c community specified for queries</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;enable&quot;, &quot;disable&quot;]</span>
<span class="s1">  snmp_v2c_name:</span>
<span class="s1">    description:</span>
<span class="s1">     -specifies the v2c community name</span>
<span class="s1">    required: False</span>
<span class="s1">  snmp_v2c_id:</span>
<span class="s1">    description:</span>
<span class="s1">     -primary key for the snmp community. this must be unique!</span>
<span class="s1">    required: False</span>
<span class="s1">  snmp_v2c_trap_src_ipv4:</span>
<span class="s1">    description:</span>
<span class="s1">       -source ip the traps should come from IPv4</span>
<span class="s1">    required: False</span>
<span class="s1">  snmp_v2c_trap_hosts_ipv4:</span>
<span class="s1">    description: &gt;</span>
<span class="s1">       -ipv4 addresses of the hosts that should get SNMP v2c traps, comma separated, must include mask</span>
<span class="s1">       (&quot;10.7.220.59 255.255.255.255, 10.7.220.60 255.255.255.255&quot;)</span>
<span class="s1">    required: False</span>
<span class="s1">  snmp_v2c_query_hosts_ipv4:</span>
<span class="s1">    description: &gt;</span>
<span class="s1">       -ipv4 addresses or subnets that are allowed to query SNMP v2c, comma separated</span>
<span class="s1">       (&quot;10.7.220.59 255.255.255.0, 10.7.220.0 255.255.255.0&quot;)</span>
<span class="s1">    required: False</span>
<span class="s1">  snmpv3_auth_proto:</span>
<span class="s1">    description:</span>
<span class="s1">        -snmpv3 auth protocol</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;md5&quot;, &quot;sha&quot;]</span>
<span class="s1">  snmpv3_auth_pwd:</span>
<span class="s1">    description:</span>
<span class="s1">        -snmpv3 auth pwd __ currently not encrypted! ensure this file is locked down permissions wise!</span>
<span class="s1">    required: False</span>
<span class="s1">  snmpv3_name:</span>
<span class="s1">    description:</span>
<span class="s1">      -snmpv3 user name</span>
<span class="s1">    required: False</span>
<span class="s1">  snmpv3_notify_hosts:</span>
<span class="s1">    description:</span>
<span class="s1">      -list of ipv4 hosts to send snmpv3 traps to. Comma separated IPv4 list</span>
<span class="s1">    required: False</span>
<span class="s1">  snmpv3_priv_proto:</span>
<span class="s1">    description:</span>
<span class="s1">      -snmpv3 priv protocol</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;aes&quot;, &quot;des&quot;, &quot;aes256&quot;, &quot;aes256cisco&quot;]</span>
<span class="s1">  snmpv3_priv_pwd:</span>
<span class="s1">    description:</span>
<span class="s1">     -snmpv3 priv pwd __ currently not encrypted! ensure this file is locked down permissions wise!</span>
<span class="s1">    required: False</span>
<span class="s1">  snmpv3_queries:</span>
<span class="s1">    description:</span>
<span class="s1">     -allow snmpv3_queries</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;enable&quot;, &quot;disable&quot;]</span>
<span class="s1">  snmpv3_query_port:</span>
<span class="s1">    description:</span>
<span class="s1">     -snmpv3 query port</span>
<span class="s1">    required: False</span>
<span class="s1">  snmpv3_security_level:</span>
<span class="s1">    description:</span>
<span class="s1">     -snmpv3 security level</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;no-auth-no-priv&quot;, &quot;auth-no-priv&quot;, &quot;auth-priv&quot;]</span>
<span class="s1">  snmpv3_source_ip:</span>
<span class="s1">    description:</span>
<span class="s1">     -snmpv3 source ipv4 address for traps</span>
<span class="s1">    required: False</span>
<span class="s1">  snmpv3_status:</span>
<span class="s1">    description:</span>
<span class="s1">     -snmpv3 user is enabled or disabled</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;enable&quot;, &quot;disable&quot;]</span>
<span class="s1">  snmpv3_trap_rport:</span>
<span class="s1">    description:</span>
<span class="s1">     -snmpv3 trap remote port</span>
<span class="s1">    required: False</span>
<span class="s1">  snmpv3_trap_status:</span>
<span class="s1">    description:</span>
<span class="s1">     -snmpv3 traps is enabled or disabled</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;enable&quot;, &quot;disable&quot;]</span>
<span class="s1">  syslog_port:</span>
<span class="s1">    description:</span>
<span class="s1">     -syslog port that will be set</span>
<span class="s1">    required: False</span>
<span class="s1">  syslog_server:</span>
<span class="s1">    description:</span>
<span class="s1">     -server the syslogs will be sent to</span>
<span class="s1">    required: False</span>
<span class="s1">  syslog_status:</span>
<span class="s1">    description:</span>
<span class="s1">     -enables or disables syslogs</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;enable&quot;, &quot;disable&quot;]</span>
<span class="s1">  syslog_mode:</span>
<span class="s1">    description:</span>
<span class="s1">      - Remote syslog logging over UDP/Reliable TCP.</span>
<span class="s1">      - choice | udp | Enable syslogging over UDP.</span>
<span class="s1">      - choice | legacy-reliable | Enable legacy reliable syslogging by RFC3195 (Reliable Delivery for Syslog).</span>
<span class="s1">      - choice | reliable | Enable reliable syslogging by RFC6587 (Transmission of Syslog Messages over TCP).</span>
<span class="s1">    required: false</span>
<span class="s1">    choices: [&quot;udp&quot;, &quot;legacy-reliable&quot;, &quot;reliable&quot;]</span>
<span class="s1">    default: &quot;udp&quot;</span>
<span class="s1">  syslog_filter:</span>
<span class="s1">    description:</span>
<span class="s1">     -sets the logging level for syslog</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;emergency&quot;, &quot;alert&quot;, &quot;critical&quot;, &quot;error&quot;, &quot;warning&quot;, &quot;notification&quot;, &quot;information&quot;, &quot;debug&quot;]</span>
<span class="s1">  syslog_facility:</span>
<span class="s1">    description:</span>
<span class="s1">      - Remote syslog facility.</span>
<span class="s1">      - choice | kernel | Kernel messages.</span>
<span class="s1">      - choice | user | Random user-level messages.</span>
<span class="s1">      - choice | mail | Mail system.</span>
<span class="s1">      - choice | daemon | System daemons.</span>
<span class="s1">      - choice | auth | Security/authorization messages.</span>
<span class="s1">      - choice | syslog | Messages generated internally by syslog.</span>
<span class="s1">      - choice | lpr | Line printer subsystem.</span>
<span class="s1">      - choice | news | Network news subsystem.</span>
<span class="s1">      - choice | uucp | Network news subsystem.</span>
<span class="s1">      - choice | cron | Clock daemon.</span>
<span class="s1">      - choice | authpriv | Security/authorization messages (private).</span>
<span class="s1">      - choice | ftp | FTP daemon.</span>
<span class="s1">      - choice | ntp | NTP daemon.</span>
<span class="s1">      - choice | audit | Log audit.</span>
<span class="s1">      - choice | alert | Log alert.</span>
<span class="s1">      - choice | clock | Clock daemon.</span>
<span class="s1">      - choice | local0 | Reserved for local use.</span>
<span class="s1">      - choice | local1 | Reserved for local use.</span>
<span class="s1">      - choice | local2 | Reserved for local use.</span>
<span class="s1">      - choice | local3 | Reserved for local use.</span>
<span class="s1">      - choice | local4 | Reserved for local use.</span>
<span class="s1">      - choice | local5 | Reserved for local use.</span>
<span class="s1">      - choice | local6 | Reserved for local use.</span>
<span class="s1">      - choice | local7 | Reserved for local use.</span>
<span class="s1">    required: false</span>
<span class="s1">    choices: [&quot;kernel&quot;, &quot;user&quot;, &quot;mail&quot;, &quot;daemon&quot;, &quot;auth&quot;, &quot;syslog&quot;,</span>
<span class="s1">    &quot;lpr&quot;, &quot;news&quot;, &quot;uucp&quot;, &quot;cron&quot;, &quot;authpriv&quot;, &quot;ftp&quot;, &quot;ntp&quot;, &quot;audit&quot;,</span>
<span class="s1">    &quot;alert&quot;, &quot;clock&quot;, &quot;local0&quot;, &quot;local1&quot;, &quot;local2&quot;, &quot;local3&quot;, &quot;local4&quot;, &quot;local5&quot;, &quot;local6&quot;, &quot;local7&quot;]</span>
<span class="s1">    default: &quot;syslog&quot;</span>
<span class="s1">  syslog_enc_algorithm:</span>
<span class="s1">    description:</span>
<span class="s1">      - Enable/disable reliable syslogging with TLS encryption.</span>
<span class="s1">      - choice | high | SSL communication with high encryption algorithms.</span>
<span class="s1">      - choice | low | SSL communication with low encryption algorithms.</span>
<span class="s1">      - choice | disable | Disable SSL communication.</span>
<span class="s1">      - choice | high-medium | SSL communication with high and medium encryption algorithms.</span>
<span class="s1">    required: false</span>
<span class="s1">    choices: [&quot;high&quot;, &quot;low&quot;, &quot;disable&quot;, &quot;high-medium&quot;]</span>
<span class="s1">    default: &quot;disable&quot;</span>
<span class="s1">  syslog_certificate:</span>
<span class="s1">    description:</span>
<span class="s1">      - Certificate used to communicate with Syslog server if encryption on.</span>
<span class="s1">    required: false</span>
<span class="s1">  ntp_status:</span>
<span class="s1">    description:</span>
<span class="s1">      -enables or disables ntp</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;enable&quot;, &quot;disable&quot;]</span>
<span class="s1">  ntp_sync_interval:</span>
<span class="s1">    description:</span>
<span class="s1">     -sets the interval in minutes for ntp sync</span>
<span class="s1">    required: False</span>
<span class="s1">  ntp_type:</span>
<span class="s1">    description:</span>
<span class="s1">     -enables fortiguard servers or custom servers are the ntp source</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;fortiguard&quot;, &quot;custom&quot;]</span>
<span class="s1">  ntp_server:</span>
<span class="s1">    description:</span>
<span class="s1">     -only used with custom ntp_type -- specifies IP of server to sync to -- comma separated ip addresses for multiples</span>
<span class="s1">    required: False</span>
<span class="s1">  ntp_auth:</span>
<span class="s1">    description:</span>
<span class="s1">     -enables or disables ntp authentication</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;enable&quot;, &quot;disable&quot;]</span>
<span class="s1">  ntp_auth_pwd:</span>
<span class="s1">    description:</span>
<span class="s1">     -sets the ntp auth password</span>
<span class="s1">    required: False</span>
<span class="s1">  ntp_v3:</span>
<span class="s1">    description:</span>
<span class="s1">     -enables or disables ntpv3 (default is ntpv4)</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;enable&quot;, &quot;disable&quot;]</span>
<span class="s1">  admin_https_redirect:</span>
<span class="s1">    description:</span>
<span class="s1">     -enables or disables https redirect from http</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;enable&quot;, &quot;disable&quot;]</span>
<span class="s1">  admin_https_port:</span>
<span class="s1">    description:</span>
<span class="s1">     -ssl admin gui port number</span>
<span class="s1">    required: False</span>
<span class="s1">  admin_http_port:</span>
<span class="s1">    description:</span>
<span class="s1">     -non-ssl admin gui port number</span>
<span class="s1">    required: False</span>
<span class="s1">  admin_timeout:</span>
<span class="s1">    description:</span>
<span class="s1">     -admin timeout in minutes</span>
<span class="s1">    required: False</span>
<span class="s1">  admin_language:</span>
<span class="s1">    description:</span>
<span class="s1">     -sets the admin gui language</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;english&quot;, &quot;simch&quot;, &quot;japanese&quot;, &quot;korean&quot;, &quot;spanish&quot;, &quot;trach&quot;, &quot;french&quot;, &quot;portuguese&quot;]</span>
<span class="s1">  admin_switch_controller:</span>
<span class="s1">    description:</span>
<span class="s1">     -enables or disables the switch controller</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;enable&quot;, &quot;disable&quot;]</span>
<span class="s1">  admin_gui_theme:</span>
<span class="s1">    description:</span>
<span class="s1">     -changes the admin gui theme</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;green&quot;, &quot;red&quot;, &quot;blue&quot;, &quot;melongene&quot;, &quot;mariner&quot;]</span>
<span class="s1">  admin_enable_fortiguard:</span>
<span class="s1">    description:</span>
<span class="s1">     -enables fortiguard security updates to their default settings. (custom fortiguard servers not yet supported)</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;none&quot;, &quot;direct&quot;, &quot;this-fmg&quot;]</span>
<span class="s1">  admin_fortianalyzer_target:</span>
<span class="s1">    description:</span>
<span class="s1">     -configures faz target</span>
<span class="s1">    required: False</span>
<span class="s1">  admin_fortiguard_target:</span>
<span class="s1">    description:</span>
<span class="s1">     - configures fortiguard target</span>
<span class="s1">     - admin_enable_fortiguard must be set to &quot;direct&quot;</span>
<span class="s1">    required: False</span>
<span class="s1">  smtp_username:</span>
<span class="s1">    description:</span>
<span class="s1">     -smtp auth username</span>
<span class="s1">    required: False</span>
<span class="s1">  smtp_password:</span>
<span class="s1">    description:</span>
<span class="s1">     -smtp password</span>
<span class="s1">    required: False</span>
<span class="s1">  smtp_port:</span>
<span class="s1">    description:</span>
<span class="s1">     -smtp port number</span>
<span class="s1">    required: False</span>
<span class="s1">  smtp_replyto:</span>
<span class="s1">    description:</span>
<span class="s1">     -smtp reply to address</span>
<span class="s1">    required: False</span>
<span class="s1">  smtp_conn_sec:</span>
<span class="s1">    description:</span>
<span class="s1">     -defines the ssl level for smtp</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;none&quot;, &quot;starttls&quot;, &quot;smtps&quot;]</span>
<span class="s1">  smtp_server:</span>
<span class="s1">    description:</span>
<span class="s1">     -smtp server ipv4 address</span>
<span class="s1">    required: False</span>
<span class="s1">  smtp_source_ipv4:</span>
<span class="s1">    description:</span>
<span class="s1">     -smtp source ip address</span>
<span class="s1">    required: False</span>
<span class="s1">  smtp_validate_cert:</span>
<span class="s1">    description:</span>
<span class="s1">     -enables or disables valid certificate checking for smtp</span>
<span class="s1">    required: False</span>
<span class="s1">    choices: [&quot;enable&quot;, &quot;disable&quot;]</span>
<span class="s1">  dns_suffix:</span>
<span class="s1">    description:</span>
<span class="s1">     -sets the local dns domain suffix</span>
<span class="s1">    required: False</span>
<span class="s1">  dns_primary_ipv4:</span>
<span class="s1">    description:</span>
<span class="s1">     -primary ipv4 dns forwarder</span>
<span class="s1">    required: False</span>
<span class="s1">  dns_secondary_ipv4:</span>
<span class="s1">    description:</span>
<span class="s1">     -secondary ipv4 dns forwarder</span>
<span class="s1">    required: False</span>
<span class="s1">  delete_provisioning_template:</span>
<span class="s1">    description:</span>
<span class="s1">     - If specified, all other options are ignored. The specified provisioning template will be deleted.</span>
<span class="s1">    required: False</span>

<span class="s1">&#39;&#39;&#39;</span>

<span class="n">EXAMPLES</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">- name: SET SNMP SYSTEM INFO</span>
<span class="s1">  fmgr_device_provision_template:</span>
<span class="s1">    host: &quot;{{inventory_hostname}}&quot;</span>
<span class="s1">    username: &quot;{{ username }}&quot;</span>
<span class="s1">    password: &quot;{{ password }}&quot;</span>
<span class="s1">    provisioning_template: &quot;default&quot;</span>
<span class="s1">    snmp_status: &quot;enable&quot;</span>
<span class="s1">    state: &quot;present&quot;</span>

<span class="s1">- name: SET SNMP SYSTEM INFO ANSIBLE ADOM</span>
<span class="s1">  fmgr_device_provision_template:</span>
<span class="s1">    host: &quot;{{inventory_hostname}}&quot;</span>
<span class="s1">    username: &quot;{{ username }}&quot;</span>
<span class="s1">    password: &quot;{{ password }}&quot;</span>
<span class="s1">    provisioning_template: &quot;default&quot;</span>
<span class="s1">    snmp_status: &quot;enable&quot;</span>
<span class="s1">    state: &quot;present&quot;</span>
<span class="s1">    adom: &quot;ansible&quot;</span>

<span class="s1">- name: SET SNMP SYSTEM INFO different template (SNMPv2)</span>
<span class="s1">  fmgr_device_provision_template:</span>
<span class="s1">    host: &quot;{{inventory_hostname}}&quot;</span>
<span class="s1">    username: &quot;{{ username }}&quot;</span>
<span class="s1">    password: &quot;{{ password }}&quot;</span>
<span class="s1">    provisioning_template: &quot;ansibleTest&quot;</span>
<span class="s1">    snmp_status: &quot;enable&quot;</span>
<span class="s1">    state: &quot;present&quot;</span>
<span class="s1">    adom: &quot;ansible&quot;</span>
<span class="s1">    snmp_v2c_query_port: &quot;162&quot;</span>
<span class="s1">    snmp_v2c_trap_port: &quot;161&quot;</span>
<span class="s1">    snmp_v2c_status: &quot;enable&quot;</span>
<span class="s1">    snmp_v2c_trap_status: &quot;enable&quot;</span>
<span class="s1">    snmp_v2c_query_status: &quot;enable&quot;</span>
<span class="s1">    snmp_v2c_name: &quot;ansibleV2c&quot;</span>
<span class="s1">    snmp_v2c_id: &quot;1&quot;</span>
<span class="s1">    snmp_v2c_trap_src_ipv4: &quot;10.7.220.41&quot;</span>
<span class="s1">    snmp_v2c_trap_hosts_ipv4: &quot;10.7.220.59 255.255.255.255, 10.7.220.60 255.255.255.255&quot;</span>
<span class="s1">    snmp_v2c_query_hosts_ipv4: &quot;10.7.220.59 255.255.255.255, 10.7.220.0 255.255.255.0&quot;</span>

<span class="s1">- name: SET SNMP SYSTEM INFO different template (SNMPv3)</span>
<span class="s1">  fmgr_device_provision_template:</span>
<span class="s1">    host: &quot;{{inventory_hostname}}&quot;</span>
<span class="s1">    username: &quot;{{ username }}&quot;</span>
<span class="s1">    password: &quot;{{ password }}&quot;</span>
<span class="s1">    provisioning_template: &quot;ansibleTest&quot;</span>
<span class="s1">    snmp_status: &quot;enable&quot;</span>
<span class="s1">    state: &quot;present&quot;</span>
<span class="s1">    adom: &quot;ansible&quot;</span>
<span class="s1">    snmpv3_auth_proto: &quot;sha&quot;</span>
<span class="s1">    snmpv3_auth_pwd: &quot;fortinet&quot;</span>
<span class="s1">    snmpv3_name: &quot;ansibleSNMPv3&quot;</span>
<span class="s1">    snmpv3_notify_hosts: &quot;10.7.220.59,10.7.220.60&quot;</span>
<span class="s1">    snmpv3_priv_proto: &quot;aes256&quot;</span>
<span class="s1">    snmpv3_priv_pwd: &quot;fortinet&quot;</span>
<span class="s1">    snmpv3_queries: &quot;enable&quot;</span>
<span class="s1">    snmpv3_query_port: &quot;161&quot;</span>
<span class="s1">    snmpv3_security_level: &quot;auth_priv&quot;</span>
<span class="s1">    snmpv3_source_ip: &quot;0.0.0.0&quot;</span>
<span class="s1">    snmpv3_status: &quot;enable&quot;</span>
<span class="s1">    snmpv3_trap_rport: &quot;162&quot;</span>
<span class="s1">    snmpv3_trap_status: &quot;enable&quot;</span>

<span class="s1">- name: SET SYSLOG INFO</span>
<span class="s1">  fmgr_device_provision_template:</span>
<span class="s1">    host: &quot;{{inventory_hostname}}&quot;</span>
<span class="s1">    username: &quot;{{ username }}&quot;</span>
<span class="s1">    password: &quot;{{ password }}&quot;</span>
<span class="s1">    provisioning_template: &quot;ansibleTest&quot;</span>
<span class="s1">    state: &quot;present&quot;</span>
<span class="s1">    adom: &quot;ansible&quot;</span>
<span class="s1">    syslog_server: &quot;10.7.220.59&quot;</span>
<span class="s1">    syslog_port: &quot;514&quot;</span>
<span class="s1">    syslog_mode: &quot;disable&quot;</span>
<span class="s1">    syslog_status: &quot;enable&quot;</span>
<span class="s1">    syslog_filter: &quot;information&quot;</span>

<span class="s1">- name: SET NTP TO FORTIGUARD</span>
<span class="s1">  fmgr_device_provision_template:</span>
<span class="s1">    host: &quot;{{inventory_hostname}}&quot;</span>
<span class="s1">    username: &quot;{{ username }}&quot;</span>
<span class="s1">    password: &quot;{{ password }}&quot;</span>
<span class="s1">    provisioning_template: &quot;ansibleTest&quot;</span>
<span class="s1">    state: &quot;present&quot;</span>
<span class="s1">    adom: &quot;ansible&quot;</span>
<span class="s1">    ntp_status: &quot;enable&quot;</span>
<span class="s1">    ntp_sync_interval: &quot;60&quot;</span>
<span class="s1">    type: &quot;fortiguard&quot;</span>

<span class="s1">- name: SET NTP TO CUSTOM SERVER</span>
<span class="s1">  fmgr_device_provision_template:</span>
<span class="s1">    host: &quot;{{inventory_hostname}}&quot;</span>
<span class="s1">    username: &quot;{{ username }}&quot;</span>
<span class="s1">    password: &quot;{{ password }}&quot;</span>
<span class="s1">    provisioning_template: &quot;ansibleTest&quot;</span>
<span class="s1">    state: &quot;present&quot;</span>
<span class="s1">    adom: &quot;ansible&quot;</span>
<span class="s1">    ntp_status: &quot;enable&quot;</span>
<span class="s1">    ntp_sync_interval: &quot;60&quot;</span>
<span class="s1">    ntp_type: &quot;custom&quot;</span>
<span class="s1">    ntp_server: &quot;10.7.220.32,10.7.220.1&quot;</span>
<span class="s1">    ntp_auth: &quot;enable&quot;</span>
<span class="s1">    ntp_auth_pwd: &quot;fortinet&quot;</span>
<span class="s1">    ntp_v3: &quot;disable&quot;</span>

<span class="s1">- name: SET ADMIN GLOBAL SETTINGS</span>
<span class="s1">  fmgr_device_provision_template:</span>
<span class="s1">    host: &quot;{{inventory_hostname}}&quot;</span>
<span class="s1">    username: &quot;{{ username }}&quot;</span>
<span class="s1">    password: &quot;{{ password }}&quot;</span>
<span class="s1">    provisioning_template: &quot;ansibleTest&quot;</span>
<span class="s1">    state: &quot;present&quot;</span>
<span class="s1">    adom: &quot;ansible&quot;</span>
<span class="s1">    admin_https_redirect: &quot;enable&quot;</span>
<span class="s1">    admin_https_port: &quot;4433&quot;</span>
<span class="s1">    admin_http_port: &quot;8080&quot;</span>
<span class="s1">    admin_timeout: &quot;30&quot;</span>
<span class="s1">    admin_language: &quot;english&quot;</span>
<span class="s1">    admin_switch_controller: &quot;enable&quot;</span>
<span class="s1">    admin_gui_theme: &quot;blue&quot;</span>
<span class="s1">    admin_enable_fortiguard: &quot;direct&quot;</span>
<span class="s1">    admin_fortiguard_target: &quot;10.7.220.128&quot;</span>
<span class="s1">    admin_fortianalyzer_target: &quot;10.7.220.61&quot;</span>

<span class="s1">- name: SET CUSTOM SMTP SERVER</span>
<span class="s1">  fmgr_device_provision_template:</span>
<span class="s1">    host: &quot;{{inventory_hostname}}&quot;</span>
<span class="s1">    username: &quot;{{ username }}&quot;</span>
<span class="s1">    password: &quot;{{ password }}&quot;</span>
<span class="s1">    provisioning_template: &quot;ansibleTest&quot;</span>
<span class="s1">    state: &quot;present&quot;</span>
<span class="s1">    adom: &quot;ansible&quot;</span>
<span class="s1">    smtp_username: &quot;ansible&quot;</span>
<span class="s1">    smtp_password: &quot;fortinet&quot;</span>
<span class="s1">    smtp_port: &quot;25&quot;</span>
<span class="s1">    smtp_replyto: &quot;ansible@do-not-reply.com&quot;</span>
<span class="s1">    smtp_conn_sec: &quot;starttls&quot;</span>
<span class="s1">    smtp_server: &quot;10.7.220.32&quot;</span>
<span class="s1">    smtp_source_ipv4: &quot;0.0.0.0&quot;</span>
<span class="s1">    smtp_validate_cert: &quot;disable&quot;</span>

<span class="s1">- name: SET DNS SERVERS</span>
<span class="s1">  fmgr_device_provision_template:</span>
<span class="s1">    host: &quot;{{inventory_hostname}}&quot;</span>
<span class="s1">    username: &quot;{{ username }}&quot;</span>
<span class="s1">    password: &quot;{{ password }}&quot;</span>
<span class="s1">    provisioning_template: &quot;ansibleTest&quot;</span>
<span class="s1">    state: &quot;present&quot;</span>
<span class="s1">    adom: &quot;ansible&quot;</span>
<span class="s1">    dns_suffix: &quot;ansible.local&quot;</span>
<span class="s1">    dns_primary_ipv4: &quot;8.8.8.8&quot;</span>
<span class="s1">    dns_secondary_ipv4: &quot;4.4.4.4&quot;</span>

<span class="s1">- name: SET PROVISIONING TEMPLATE DEVICE TARGETS IN FORTIMANAGER</span>
<span class="s1">  fmgr_device_provision_template:</span>
<span class="s1">    host: &quot;{{inventory_hostname}}&quot;</span>
<span class="s1">    username: &quot;{{ username }}&quot;</span>
<span class="s1">    password: &quot;{{ password }}&quot;</span>
<span class="s1">    provisioning_template: &quot;ansibleTest&quot;</span>
<span class="s1">    state: &quot;present&quot;</span>
<span class="s1">    adom: &quot;ansible&quot;</span>
<span class="s1">    provision_targets: &quot;FGT1, FGT2&quot;</span>

<span class="s1">- name: DELETE ENTIRE PROVISIONING TEMPLATE</span>
<span class="s1">  fmgr_device_provision_template:</span>
<span class="s1">    host: &quot;{{ inventory_hostname }}&quot;</span>
<span class="s1">    username: &quot;{{ username }}&quot;</span>
<span class="s1">    password: &quot;{{ password }}&quot;</span>
<span class="s1">    delete_provisioning_template: &quot;ansibleTest&quot;</span>
<span class="s1">    state: &quot;absent&quot;</span>
<span class="s1">    adom: &quot;ansible&quot;</span>

<span class="s1">&#39;&#39;&#39;</span>
<span class="n">RETURN</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">api_result:</span>
<span class="s2">  description: full API response, includes status code and message</span>
<span class="s2">  returned: always</span>
<span class="s2">  type: string</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">ansible.module_utils.basic</span> <span class="kn">import</span> <span class="n">AnsibleModule</span><span class="p">,</span> <span class="n">env_fallback</span>
<span class="kn">from</span> <span class="nn">ansible.module_utils.network.fortimanager.fortimanager</span> <span class="kn">import</span> <span class="n">AnsibleFortiManager</span>

<span class="c1"># check for pyFMG lib</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">pyFMG.fortimgr</span> <span class="kn">import</span> <span class="n">FortiManager</span>

    <span class="n">HAS_PYFMGR</span> <span class="o">=</span> <span class="bp">True</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">HAS_PYFMGR</span> <span class="o">=</span> <span class="bp">False</span>


<span class="k">def</span> <span class="nf">get_devprof</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    GET the DevProf (check to see if exists)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># &quot;name&quot;: paramgram[&quot;provisioning_template&quot;]</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/devprof/adom/{adom}/{name}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">del_devprof</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DELETE the DevProf</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># &quot;name&quot;: paramgram[&quot;delete_provisioning_template&quot;]</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/devprof/adom/{adom}/{name}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                                  <span class="n">name</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;delete_provisioning_template&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">add_devprof</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    GET the DevProf (check to see if exists)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">],</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;devprof&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;CreatedByAnsible&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/devprof/adom/{adom}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">get_devprof_scope</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    GETS a device provisioning template and its scope</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">],</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;devprof&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;CreatedByAnsible&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/devprof/adom/{adom}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">set_devprof_scope</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SETS a device provisioning template and its scope</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">],</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;devprof&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;CreatedByAnsible&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">targets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provision_targets&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
        <span class="c1"># split the host on the space to get the mask out</span>
        <span class="n">new_target</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">}</span>
        <span class="n">targets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_target</span><span class="p">)</span>

    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;scope member&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">targets</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/devprof/adom/{adom}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">delete_devprof_scope</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DELETES the Current Scope for ProvTemplate</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">],</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;devprof&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;CreatedByAnsible&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scope member&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;targets_to_add&quot;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/devprof/adom/{adom}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">set_devprof_snmp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ENABLE SNMP ON DevProf</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_status&quot;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}/devprof/&quot;</span> \
          <span class="s2">&quot;{provisioning_template}/system/snmp/sysinfo&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                                               <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">delete_devprof_snmp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DISABLE SNMP on Provision Template</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_status&quot;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}/devprof/&quot;</span> \
          <span class="s2">&quot;{provisioning_template}/system/snmp/sysinfo&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                                               <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">set_devprof_snmp_v2c</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ENABLE SNMP ON DevProf</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;query-v2c-port&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_query_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;trap-v2c-rport&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;trap-v2c-status&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;query-v2c-status&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_query_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_name&quot;</span><span class="p">],</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_id&quot;</span><span class="p">],</span>
        <span class="s2">&quot;meta fields&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(),</span>
        <span class="s2">&quot;hosts&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(),</span>
        <span class="s2">&quot;events&quot;</span><span class="p">:</span> <span class="mi">411578417151</span><span class="p">,</span>
        <span class="s2">&quot;query-v1-status&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;query-v1-port&quot;</span><span class="p">:</span> <span class="mi">161</span><span class="p">,</span>
        <span class="s2">&quot;trap-v1-status&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;trap-v1-lport&quot;</span><span class="p">:</span> <span class="mi">162</span><span class="p">,</span>
        <span class="s2">&quot;trap-v1-rport&quot;</span><span class="p">:</span> <span class="mi">162</span><span class="p">,</span>
        <span class="s2">&quot;trap-v2c-lport&quot;</span><span class="p">:</span> <span class="mi">162</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># BUILD THE HOST STRINGS</span>
    <span class="n">id_counter</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_hosts_ipv4&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_query_hosts_ipv4&quot;</span><span class="p">]:</span>
        <span class="n">hosts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_query_hosts_ipv4&quot;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">ipv4_host</span> <span class="ow">in</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_query_hosts_ipv4&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
                <span class="c1"># split the host on the space to get the mask out</span>
                <span class="n">new_ipv4_host</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ha-direct&quot;</span><span class="p">:</span> <span class="s2">&quot;enable&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;host-type&quot;</span><span class="p">:</span> <span class="s2">&quot;query&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">id_counter</span><span class="p">,</span>
                                 <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="n">ipv4_host</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
                                 <span class="s2">&quot;meta fields&quot;</span><span class="p">:</span> <span class="p">{},</span>
                                 <span class="s2">&quot;source-ip&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0.0.0&quot;</span><span class="p">}</span>
                <span class="n">hosts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_ipv4_host</span><span class="p">)</span>
                <span class="n">id_counter</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_hosts_ipv4&quot;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">ipv4_host</span> <span class="ow">in</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_hosts_ipv4&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
                <span class="c1"># split the host on the space to get the mask out</span>
                <span class="n">new_ipv4_host</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ha-direct&quot;</span><span class="p">:</span> <span class="s2">&quot;enable&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;host-type&quot;</span><span class="p">:</span> <span class="s2">&quot;trap&quot;</span><span class="p">,</span>
                                 <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">id_counter</span><span class="p">,</span>
                                 <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="n">ipv4_host</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
                                 <span class="s2">&quot;meta fields&quot;</span><span class="p">:</span> <span class="p">{},</span>
                                 <span class="s2">&quot;source-ip&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_src_ipv4&quot;</span><span class="p">]}</span>
                <span class="n">hosts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_ipv4_host</span><span class="p">)</span>
                <span class="n">id_counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;hosts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hosts</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}/devprof/&quot;</span> \
          <span class="s2">&quot;{provisioning_template}/system/snmp/community&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                                                 <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span>
                                                                     <span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">delete_devprof_snmp_v2c</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DISABLE SNMP on Provision Template</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;confirm&quot;</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}/&quot;</span> \
          <span class="s2">&quot;devprof/{provisioning_template}/&quot;</span> \
          <span class="s2">&quot;system/snmp/community/{snmp_v2c_id}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                                       <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">],</span>
                                                       <span class="n">snmp_v2c_id</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_id&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">set_devprof_snmp_v3</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ENABLE SNMP ON DevProf</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="c1"># transform options</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_trap_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;trap-status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_trap_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;disable&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;trap-status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_queries&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;queries&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_queries&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;disable&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;queries&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;disable&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_auth_proto&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;md5&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;auth-proto&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_auth_proto&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;sha&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;auth-proto&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_priv_proto&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;aes&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;auth-proto&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_priv_proto&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;des&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;priv-proto&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_priv_proto&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;aes256&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;priv-proto&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_priv_proto&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;aes256cisco&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;priv-proto&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_security_level&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;no-auth-no-priv&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;security-level&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_security_level&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;auth-no-priv&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;security-level&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_security_level&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;auth-priv&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;security-level&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;auth-pwd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_auth_pwd&quot;</span><span class="p">]</span>
    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;priv-pwd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_priv_pwd&quot;</span><span class="p">]</span>
    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;trap-rport&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_trap_rport&quot;</span><span class="p">]</span>
    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;query-port&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_query_port&quot;</span><span class="p">]</span>
    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_name&quot;</span><span class="p">]</span>
    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;notify-hosts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_notify_hosts&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;events&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1647387997183</span>
    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;trap-lport&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">162</span>

    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;source-ip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_source_ip&quot;</span><span class="p">]</span>
    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ha-direct&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}/&quot;</span> \
          <span class="s2">&quot;devprof/{provisioning_template}/&quot;</span> \
          <span class="s2">&quot;system/snmp/user&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                    <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">delete_devprof_snmp_v3</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DISABLE SNMP on Provision Template</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;confirm&quot;</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}/devprof/&quot;</span> \
          <span class="s2">&quot;{provisioning_template}/system/snmp&quot;</span> \
          <span class="s2">&quot;/user/{snmpv3_name}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                       <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">],</span>
                                       <span class="n">snmpv3_name</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_name&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">set_devprof_syslog</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the SYSLOG SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;server&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_server&quot;</span><span class="p">],</span>
        <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_mode&quot;</span><span class="p">],</span>
        <span class="s2">&quot;facility&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_facility&quot;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_enc_algorithm&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">,</span> <span class="s2">&quot;high-medium&quot;</span><span class="p">]</span> \
            <span class="ow">and</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_certificate&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;certificate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;certificate&quot;</span><span class="p">]</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;enc-algorithm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_enc_algorithm&quot;</span><span class="p">]</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}/&quot;</span> \
          <span class="s2">&quot;devprof/{provisioning_template}/&quot;</span> \
          <span class="s2">&quot;log/syslogd/setting&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                       <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">delete_devprof_syslog</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DISABLE SYSLOG SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;server&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_server&quot;</span><span class="p">],</span>
        <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_mode&quot;</span><span class="p">],</span>
        <span class="s2">&quot;facility&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_facility&quot;</span><span class="p">]</span>
    <span class="p">}</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}/&quot;</span> \
          <span class="s2">&quot;devprof/{provisioning_template}/&quot;</span> \
          <span class="s2">&quot;log/syslogd/setting&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                       <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">set_devprof_syslog_filter</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the SYSLOG SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_filter&quot;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/log/syslogd/filter&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                       <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">delete_devprof_syslog_filter</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DISABLE SYSLOG SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_filter&quot;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/log/syslogd/filter&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                       <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">set_devprof_ntp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the NTP SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;msg&quot;</span><span class="p">:</span> <span class="s2">&quot;Illegal or malformed paramgram discovered. System Exception&quot;</span><span class="p">})</span>
    <span class="c1"># IF SET TO FORTIGUARD, BUILD A STRING SPECIFIC TO THAT</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;fortiguard&quot;</span><span class="p">:</span>
        <span class="n">datagram</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ntpsync&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;disable&quot;</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ntpsync&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_sync_interval&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;syncinterval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;syncinterval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_sync_interval&quot;</span><span class="p">]</span>

        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># IF THE NTP TYPE IS CUSTOM BUILD THE SERVER LIST</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;custom&quot;</span><span class="p">:</span>
        <span class="n">id_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">key_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ntpservers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">datagram</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ntpsync&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;disable&quot;</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ntpsync&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;syncinterval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_sync_interval&quot;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;syncinterval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_server&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
            <span class="n">id_counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">server_fields</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

            <span class="n">key_counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_auth&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;authentication&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_auth_pwd&quot;</span><span class="p">]</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;key-id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_counter</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;authentication&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;key-id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_counter</span>

            <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_v3&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;ntp_v3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;ntp_v3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># split the host on the space to get the mask out</span>
            <span class="n">new_ntp_server</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;authentication&quot;</span><span class="p">:</span> <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;authentication&quot;</span><span class="p">],</span>
                              <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">id_counter</span><span class="p">,</span> <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span>
                              <span class="s2">&quot;key-id&quot;</span><span class="p">:</span> <span class="n">id_counter</span><span class="p">,</span> <span class="s2">&quot;ntpv3&quot;</span><span class="p">:</span> <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;ntp_v3&quot;</span><span class="p">],</span>
                              <span class="s2">&quot;server&quot;</span><span class="p">:</span> <span class="n">server</span><span class="p">}</span>
            <span class="n">ntpservers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_ntp_server</span><span class="p">)</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ntpserver&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ntpservers</span>

    <span class="c1"># SET THE BODY FOR THE FORTIGUARD REQUEST</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/system/ntp&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                               <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">delete_devprof_ntp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DISABLE NTP SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;msg&quot;</span><span class="p">:</span> <span class="s2">&quot;Illegal or malformed paramgram discovered. System Exception&quot;</span><span class="p">})</span>
    <span class="c1"># IF SET TO FORTIGUARD, BUILD A STRING SPECIFIC TO THAT</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;fortiguard&quot;</span><span class="p">:</span>
        <span class="n">datagram</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ntpsync&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;disable&quot;</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ntpsync&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_sync_interval&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;syncinterval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;syncinterval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_sync_interval&quot;</span><span class="p">]</span>

        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># IF THE NTP TYPE IS CUSTOM BUILD THE SERVER LIST</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;custom&quot;</span><span class="p">:</span>
        <span class="n">id_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">key_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ntpservers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">datagram</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ntpsync&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;disable&quot;</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ntpsync&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_sync_interval&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;syncinterval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;syncinterval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_sync_interval&quot;</span><span class="p">]</span>
            <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_server&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
            <span class="n">id_counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">server_fields</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

            <span class="n">key_counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_auth&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;authentication&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_auth_pwd&quot;</span><span class="p">]</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;key-id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_counter</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;authentication&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;key-id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_counter</span>

            <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_v3&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;ntpv3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;ntpv3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># split the host on the space to get the mask out</span>
            <span class="n">new_ntp_server</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;authentication&quot;</span><span class="p">:</span> <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;authentication&quot;</span><span class="p">],</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">id_counter</span><span class="p">,</span>
                              <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span> <span class="s2">&quot;key-id&quot;</span><span class="p">:</span> <span class="n">id_counter</span><span class="p">,</span> <span class="s2">&quot;ntpv3&quot;</span><span class="p">:</span> <span class="n">server_fields</span><span class="p">[</span><span class="s2">&quot;ntpv3&quot;</span><span class="p">],</span>
                              <span class="s2">&quot;server&quot;</span><span class="p">:</span> <span class="n">server</span><span class="p">}</span>
            <span class="n">ntpservers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_ntp_server</span><span class="p">)</span>

        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;ntpserver&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ntpservers</span>

    <span class="c1"># SET THE BODY FOR THE FORTIGUARD REQUEST</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/system/ntp&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                               <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">set_devprof_admin</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        DISABLE NTP SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;admin-https-redirect&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_https_redirect&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin-port&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_http_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin-sport&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_https_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admintimeout&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_timeout&quot;</span><span class="p">],</span>
        <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_language&quot;</span><span class="p">],</span>
        <span class="s2">&quot;gui-theme&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_gui_theme&quot;</span><span class="p">],</span>
        <span class="s2">&quot;switch-controller&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_switch_controller&quot;</span><span class="p">],</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/system/global&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                  <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">delete_devprof_admin</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        CHANGE ADMIN SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;admin-https-redirect&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_https_redirect&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin-port&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_http_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin-sport&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_https_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admintimeout&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_timeout&quot;</span><span class="p">],</span>
        <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_language&quot;</span><span class="p">],</span>
        <span class="s2">&quot;gui-theme&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_gui_theme&quot;</span><span class="p">],</span>
        <span class="s2">&quot;switch-controller&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_switch_controller&quot;</span><span class="p">],</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/system/global&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                  <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">set_devprof_smtp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       ENABLE SMTP SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;reply-to&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_replyto&quot;</span><span class="p">],</span>
        <span class="s2">&quot;server&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_server&quot;</span><span class="p">],</span>
        <span class="s2">&quot;source-ip&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_source_ipv4&quot;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_username&quot;</span><span class="p">]:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;authenticate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;username&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_username&quot;</span><span class="p">]</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_password&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_conn_sec&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_conn_sec&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;starttls&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_conn_sec&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;smtps&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_validate_cert&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;validate-server&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;validate-server&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/system/email-server&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                        <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">delete_devprof_smtp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        DISABLE SMTP SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;reply-to&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_replyto&quot;</span><span class="p">],</span>
        <span class="s2">&quot;server&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_server&quot;</span><span class="p">],</span>
        <span class="s2">&quot;source-ip&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_source_ipv4&quot;</span><span class="p">],</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_username&quot;</span><span class="p">]:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;authenticate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;username&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_username&quot;</span><span class="p">]</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_password&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_conn_sec&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_conn_sec&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;starttls&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_conn_sec&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;smtps&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;security&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_validate_cert&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;validate-server&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;validate-server&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/system/email-server&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                        <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">set_devprof_dns</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       ENABLE DNS SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;domain&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;dns_suffix&quot;</span><span class="p">],</span>
        <span class="s2">&quot;primary&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;dns_primary_ipv4&quot;</span><span class="p">],</span>
        <span class="s2">&quot;secondary&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;dns_secondary_ipv4&quot;</span><span class="p">],</span>
    <span class="p">}</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/system/dns&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                               <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">delete_devprof_dns</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        DISABLE DNS SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;domain&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;dns_suffix&quot;</span><span class="p">],</span>
        <span class="s2">&quot;primary&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;dns_primary_ipv4&quot;</span><span class="p">],</span>
        <span class="s2">&quot;secondary&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;dns_secondary_ipv4&quot;</span><span class="p">],</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/system/dns&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                               <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">set_devprof_toggle_fg</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       TOGGLE FG SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pydevd.settrace(&#39;10.0.0.122&#39;, port=54654, stdoutToServer=True, stderrToServer=True)</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_enable_fortiguard&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;direct&quot;</span><span class="p">,</span> <span class="s2">&quot;this-fmg&quot;</span><span class="p">]:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;include-default-servers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;enable&quot;</span>
    <span class="k">elif</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_enable_fortiguard&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;include-default-servers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;disable&quot;</span>

    <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;server-list&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/system/central-management&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                              <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">set_devprof_fg</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       ENABLE FG SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pydevd.settrace(&#39;10.0.0.122&#39;, port=54654, stdoutToServer=True, stderrToServer=True)</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_enable_fortiguard&quot;</span><span class="p">],</span>
        <span class="s2">&quot;target-ip&quot;</span><span class="p">:</span> <span class="bp">None</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_fortiguard_target&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;direct&quot;</span><span class="p">:</span>
        <span class="n">datagram</span><span class="p">[</span><span class="s2">&quot;target-ip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_fortiguard_target&quot;</span><span class="p">]</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/device/profile/fortiguard&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                              <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">delete_devprof_fg</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        DISABLE FG SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_enable_fortiguard&quot;</span><span class="p">],</span>
        <span class="s2">&quot;target-ip&quot;</span><span class="p">:</span> <span class="bp">None</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/device/profile/fortiguard&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                              <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">set_devprof_faz</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       ENABLE FAZ SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;target-ip&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_fortianalyzer_target&quot;</span><span class="p">],</span>
        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/device/profile/fortianalyzer&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                                 <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">delete_devprof_faz</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        DISABLE FAZ SETTINGS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datagram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;target-ip&quot;</span><span class="p">:</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_fortianalyzer_target&quot;</span><span class="p">],</span>
        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="s2">&quot;hastarget&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/pm/config/adom/{adom}&quot;</span> \
          <span class="s2">&quot;/devprof/{provisioning_template}&quot;</span> \
          <span class="s2">&quot;/device/profile/fortianalyzer&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">adom</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
                                                 <span class="n">provisioning_template</span><span class="o">=</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">datagram</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>


<span class="k">def</span> <span class="nf">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;NULL&quot;</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="p">(),</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="n">logout_on_fail</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">logout_on_success</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    THIS METHOD CONTROLS THE LOGOUT AND ERROR REPORTING AFTER AN METHOD OR FUNCTION RUNS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># VALIDATION ERROR (NO RESULTS, JUST AN EXIT)</span>
    <span class="k">if</span> <span class="n">msg</span> <span class="o">!=</span> <span class="s2">&quot;NULL&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fmg</span><span class="o">.</span><span class="n">logout</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">module</span><span class="o">.</span><span class="n">fail_json</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># SUBMISSION ERROR</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">msg</span> <span class="o">==</span> <span class="s2">&quot;NULL&quot;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;status&#39;</span><span class="p">][</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;No status message returned from pyFMG. Possible that this was a GET with a tuple result.&quot;</span>

        <span class="k">if</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">good_codes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">logout_on_fail</span><span class="p">:</span>
                <span class="n">fmg</span><span class="o">.</span><span class="n">logout</span><span class="p">()</span>
                <span class="n">module</span><span class="o">.</span><span class="n">fail_json</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="o">**</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">logout_on_success</span><span class="p">:</span>
                <span class="n">fmg</span><span class="o">.</span><span class="n">logout</span><span class="p">()</span>
                <span class="n">module</span><span class="o">.</span><span class="n">exit_json</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s2">&quot;API Called worked, but logout handler has been asked to logout on success&quot;</span><span class="p">,</span>
                                 <span class="o">**</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">msg</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">argument_spec</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">adom</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">host</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">username</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fallback</span><span class="o">=</span><span class="p">(</span><span class="n">env_fallback</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;ANSIBLE_NET_USERNAME&quot;</span><span class="p">])),</span>
        <span class="n">password</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fallback</span><span class="o">=</span><span class="p">(</span><span class="n">env_fallback</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;ANSIBLE_NET_PASSWORD&quot;</span><span class="p">]),</span> <span class="n">no_log</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
        <span class="n">state</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;present&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;absent&quot;</span><span class="p">,</span> <span class="s2">&quot;present&quot;</span><span class="p">]),</span>

        <span class="n">provisioning_template</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">provision_targets</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>

        <span class="n">device_unique_name</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">snmp_status</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">snmp_v2c_query_port</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">snmp_v2c_trap_port</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">snmp_v2c_status</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">snmp_v2c_trap_status</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">snmp_v2c_query_status</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">snmp_v2c_name</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">no_log</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
        <span class="n">snmp_v2c_id</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">snmp_v2c_trap_src_ipv4</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">snmp_v2c_trap_hosts_ipv4</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">snmp_v2c_query_hosts_ipv4</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>

        <span class="n">snmpv3_auth_proto</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;md5&quot;</span><span class="p">,</span> <span class="s2">&quot;sha&quot;</span><span class="p">]),</span>
        <span class="n">snmpv3_auth_pwd</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">no_log</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
        <span class="n">snmpv3_name</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">snmpv3_notify_hosts</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">snmpv3_priv_proto</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;aes&quot;</span><span class="p">,</span> <span class="s2">&quot;des&quot;</span><span class="p">,</span> <span class="s2">&quot;aes256&quot;</span><span class="p">,</span> <span class="s2">&quot;aes256cisco&quot;</span><span class="p">]),</span>
        <span class="n">snmpv3_priv_pwd</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">no_log</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
        <span class="n">snmpv3_queries</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">snmpv3_query_port</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">snmpv3_security_level</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>
                                   <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;no-auth-no-priv&quot;</span><span class="p">,</span> <span class="s2">&quot;auth-no-priv&quot;</span><span class="p">,</span> <span class="s2">&quot;auth-priv&quot;</span><span class="p">]),</span>
        <span class="n">snmpv3_source_ip</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">snmpv3_status</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">snmpv3_trap_rport</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">snmpv3_trap_status</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>

        <span class="n">syslog_port</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">syslog_server</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">syslog_mode</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;udp&quot;</span><span class="p">,</span> <span class="s2">&quot;legacy-reliable&quot;</span><span class="p">,</span> <span class="s2">&quot;reliable&quot;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;udp&quot;</span><span class="p">),</span>
        <span class="n">syslog_status</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">syslog_filter</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;emergency&quot;</span><span class="p">,</span> <span class="s2">&quot;alert&quot;</span><span class="p">,</span> <span class="s2">&quot;critical&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
                                                                <span class="s2">&quot;warning&quot;</span><span class="p">,</span> <span class="s2">&quot;notification&quot;</span><span class="p">,</span> <span class="s2">&quot;information&quot;</span><span class="p">,</span> <span class="s2">&quot;debug&quot;</span><span class="p">]),</span>
        <span class="n">syslog_enc_algorithm</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">,</span> <span class="s2">&quot;high-medium&quot;</span><span class="p">],</span>
                                  <span class="n">default</span><span class="o">=</span><span class="s2">&quot;disable&quot;</span><span class="p">),</span>
        <span class="n">syslog_facility</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;kernel&quot;</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;mail&quot;</span><span class="p">,</span> <span class="s2">&quot;daemon&quot;</span><span class="p">,</span> <span class="s2">&quot;auth&quot;</span><span class="p">,</span>
                                                                  <span class="s2">&quot;syslog&quot;</span><span class="p">,</span> <span class="s2">&quot;lpr&quot;</span><span class="p">,</span> <span class="s2">&quot;news&quot;</span><span class="p">,</span> <span class="s2">&quot;uucp&quot;</span><span class="p">,</span> <span class="s2">&quot;cron&quot;</span><span class="p">,</span> <span class="s2">&quot;authpriv&quot;</span><span class="p">,</span>
                                                                  <span class="s2">&quot;ftp&quot;</span><span class="p">,</span> <span class="s2">&quot;ntp&quot;</span><span class="p">,</span> <span class="s2">&quot;audit&quot;</span><span class="p">,</span> <span class="s2">&quot;alert&quot;</span><span class="p">,</span> <span class="s2">&quot;clock&quot;</span><span class="p">,</span> <span class="s2">&quot;local0&quot;</span><span class="p">,</span>
                                                                  <span class="s2">&quot;local1&quot;</span><span class="p">,</span> <span class="s2">&quot;local2&quot;</span><span class="p">,</span> <span class="s2">&quot;local3&quot;</span><span class="p">,</span> <span class="s2">&quot;local4&quot;</span><span class="p">,</span> <span class="s2">&quot;local5&quot;</span><span class="p">,</span>
                                                                  <span class="s2">&quot;local6&quot;</span><span class="p">,</span> <span class="s2">&quot;local7&quot;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;syslog&quot;</span><span class="p">),</span>
        <span class="n">syslog_certificate</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>

        <span class="n">ntp_status</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">ntp_sync_interval</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">ntp_type</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fortiguard&quot;</span><span class="p">,</span> <span class="s2">&quot;custom&quot;</span><span class="p">]),</span>
        <span class="n">ntp_server</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">ntp_auth</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">ntp_auth_pwd</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">no_log</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
        <span class="n">ntp_v3</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>

        <span class="n">admin_https_redirect</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">admin_https_port</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">admin_http_port</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">admin_timeout</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">admin_language</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>
                            <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;english&quot;</span><span class="p">,</span> <span class="s2">&quot;simch&quot;</span><span class="p">,</span> <span class="s2">&quot;japanese&quot;</span><span class="p">,</span> <span class="s2">&quot;korean&quot;</span><span class="p">,</span>
                                     <span class="s2">&quot;spanish&quot;</span><span class="p">,</span> <span class="s2">&quot;trach&quot;</span><span class="p">,</span> <span class="s2">&quot;french&quot;</span><span class="p">,</span> <span class="s2">&quot;portuguese&quot;</span><span class="p">]),</span>
        <span class="n">admin_switch_controller</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>
        <span class="n">admin_gui_theme</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;melongene&quot;</span><span class="p">,</span> <span class="s2">&quot;mariner&quot;</span><span class="p">]),</span>
        <span class="n">admin_enable_fortiguard</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="s2">&quot;direct&quot;</span><span class="p">,</span> <span class="s2">&quot;this-fmg&quot;</span><span class="p">]),</span>
        <span class="n">admin_fortianalyzer_target</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">admin_fortiguard_target</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>

        <span class="n">smtp_username</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">smtp_password</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">no_log</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
        <span class="n">smtp_port</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
        <span class="n">smtp_replyto</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">smtp_conn_sec</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="s2">&quot;starttls&quot;</span><span class="p">,</span> <span class="s2">&quot;smtps&quot;</span><span class="p">]),</span>
        <span class="n">smtp_server</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">smtp_source_ipv4</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">smtp_validate_cert</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;disable&quot;</span><span class="p">]),</span>

        <span class="n">dns_suffix</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">dns_primary_ipv4</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">dns_secondary_ipv4</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">),</span>
        <span class="n">delete_provisioning_template</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;str&quot;</span><span class="p">)</span>

    <span class="p">)</span>

    <span class="n">module</span> <span class="o">=</span> <span class="n">AnsibleModule</span><span class="p">(</span><span class="n">argument_spec</span><span class="p">,</span> <span class="n">supports_check_mode</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="p">)</span>

    <span class="n">paramgram</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;adom&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;adom&quot;</span><span class="p">],</span>
        <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">],</span>
        <span class="s2">&quot;provision_targets&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;provision_targets&quot;</span><span class="p">],</span>
        <span class="s2">&quot;provisioning_template&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;provisioning_template&quot;</span><span class="p">],</span>

        <span class="s2">&quot;snmp_status&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmp_v2c_query_port&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_query_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmp_v2c_trap_port&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmp_v2c_status&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmp_v2c_trap_status&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmp_v2c_query_status&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_query_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmp_v2c_name&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_name&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmp_v2c_id&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_id&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmp_v2c_trap_src_ipv4&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_src_ipv4&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmp_v2c_trap_hosts_ipv4&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_hosts_ipv4&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmp_v2c_query_hosts_ipv4&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_query_hosts_ipv4&quot;</span><span class="p">],</span>

        <span class="s2">&quot;snmpv3_auth_proto&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_auth_proto&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_auth_pwd&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_auth_pwd&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_name&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_name&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_notify_hosts&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_notify_hosts&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_priv_proto&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_priv_proto&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_priv_pwd&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_priv_pwd&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_queries&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_queries&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_query_port&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_query_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_security_level&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_security_level&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_source_ip&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_source_ip&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_status&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_trap_rport&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_trap_rport&quot;</span><span class="p">],</span>
        <span class="s2">&quot;snmpv3_trap_status&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;snmpv3_trap_status&quot;</span><span class="p">],</span>

        <span class="s2">&quot;syslog_port&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;syslog_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;syslog_server&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;syslog_server&quot;</span><span class="p">],</span>
        <span class="s2">&quot;syslog_mode&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;syslog_mode&quot;</span><span class="p">],</span>
        <span class="s2">&quot;syslog_status&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;syslog_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;syslog_filter&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;syslog_filter&quot;</span><span class="p">],</span>
        <span class="s2">&quot;syslog_facility&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;syslog_facility&quot;</span><span class="p">],</span>
        <span class="s2">&quot;syslog_enc_algorithm&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;syslog_enc_algorithm&quot;</span><span class="p">],</span>
        <span class="s2">&quot;syslog_certificate&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;syslog_certificate&quot;</span><span class="p">],</span>

        <span class="s2">&quot;ntp_status&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;ntp_status&quot;</span><span class="p">],</span>
        <span class="s2">&quot;ntp_sync_interval&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;ntp_sync_interval&quot;</span><span class="p">],</span>
        <span class="s2">&quot;ntp_type&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;ntp_type&quot;</span><span class="p">],</span>
        <span class="s2">&quot;ntp_server&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;ntp_server&quot;</span><span class="p">],</span>
        <span class="s2">&quot;ntp_auth&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;ntp_auth&quot;</span><span class="p">],</span>
        <span class="s2">&quot;ntp_auth_pwd&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;ntp_auth_pwd&quot;</span><span class="p">],</span>
        <span class="s2">&quot;ntp_v3&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;ntp_v3&quot;</span><span class="p">],</span>

        <span class="s2">&quot;admin_https_redirect&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;admin_https_redirect&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin_https_port&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;admin_https_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin_http_port&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;admin_http_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin_timeout&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;admin_timeout&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin_language&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;admin_language&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin_switch_controller&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;admin_switch_controller&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin_gui_theme&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;admin_gui_theme&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin_enable_fortiguard&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;admin_enable_fortiguard&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin_fortianalyzer_target&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;admin_fortianalyzer_target&quot;</span><span class="p">],</span>
        <span class="s2">&quot;admin_fortiguard_target&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;admin_fortiguard_target&quot;</span><span class="p">],</span>

        <span class="s2">&quot;smtp_username&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;smtp_username&quot;</span><span class="p">],</span>
        <span class="s2">&quot;smtp_password&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;smtp_password&quot;</span><span class="p">],</span>
        <span class="s2">&quot;smtp_port&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;smtp_port&quot;</span><span class="p">],</span>
        <span class="s2">&quot;smtp_replyto&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;smtp_replyto&quot;</span><span class="p">],</span>
        <span class="s2">&quot;smtp_conn_sec&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;smtp_conn_sec&quot;</span><span class="p">],</span>
        <span class="s2">&quot;smtp_server&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;smtp_server&quot;</span><span class="p">],</span>
        <span class="s2">&quot;smtp_source_ipv4&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;smtp_source_ipv4&quot;</span><span class="p">],</span>
        <span class="s2">&quot;smtp_validate_cert&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;smtp_validate_cert&quot;</span><span class="p">],</span>

        <span class="s2">&quot;dns_suffix&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;dns_suffix&quot;</span><span class="p">],</span>
        <span class="s2">&quot;dns_primary_ipv4&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;dns_primary_ipv4&quot;</span><span class="p">],</span>
        <span class="s2">&quot;dns_secondary_ipv4&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;dns_secondary_ipv4&quot;</span><span class="p">],</span>
        <span class="s2">&quot;delete_provisioning_template&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;delete_provisioning_template&quot;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="c1"># validate required arguments are passed; not used in argument_spec to allow params to be called from provider</span>
    <span class="c1"># check if params are set</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;msg&quot;</span><span class="p">:</span> <span class="s2">&quot;Illegal or malformed paramgram discovered. System Exception&quot;</span><span class="p">})</span>
    <span class="k">if</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;host&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;username&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">module</span><span class="o">.</span><span class="n">fail_json</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Host and username are required for connection&quot;</span><span class="p">)</span>

    <span class="c1"># CHECK IF LOGIN FAILED</span>
    <span class="n">fmg</span> <span class="o">=</span> <span class="n">AnsibleFortiManager</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;host&quot;</span><span class="p">],</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;username&quot;</span><span class="p">],</span> <span class="n">module</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">fmg</span><span class="o">.</span><span class="n">login</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">response</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;status&#39;</span><span class="p">][</span><span class="s1">&#39;code&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">module</span><span class="o">.</span><span class="n">fail_json</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Connection to FortiManager Failed&quot;</span><span class="p">)</span>

    <span class="c1"># START SESSION LOGIC</span>
    <span class="c1"># CHECK IF WE ARE DELETING AN ENTIRE TEMPLATE. IF THAT&#39;S THE CASE DO IT FIRST AND IGNORE THE REST.</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;delete_provisioning_template&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">del_devprof</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
        <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete provisioning template&quot;</span><span class="p">,</span> <span class="n">logout_on_success</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="c1"># CHECK TO SEE IF THE DEVPROF TEMPLATE EXISTS</span>
    <span class="n">devprof</span> <span class="o">=</span> <span class="n">get_devprof</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">devprof</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">add_devprof</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
        <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>

    <span class="c1"># PROCESS THE SNMP SETTINGS IF THE SNMP_STATUS VARIABLE IS SET</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_status&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="c1"># enable SNMP in the devprof template</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_snmp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="c1"># disable SNMP in the devprof template</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_snmp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete SNMP status&quot;</span><span class="p">)</span>

    <span class="c1"># PROCESS THE SNMP V2C COMMUNITY SETTINGS IF THEY ARE ALL HERE</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">(</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_query_port&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_port&quot;</span><span class="p">],</span>
                                   <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_status&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_trap_status&quot;</span><span class="p">],</span>
                                   <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_query_status&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_name&quot;</span><span class="p">],</span>
                                   <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmp_v2c_id&quot;</span><span class="p">])):</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_snmp_v2c</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to create SNMP V2C Community&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_snmp_v2c</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete SNMP V2C Community&quot;</span><span class="p">)</span>

    <span class="c1"># PROCESS THE SNMPV3 USER IF THERE</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">(</span>
            <span class="p">[</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_auth_proto&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_auth_pwd&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_name&quot;</span><span class="p">],</span>
             <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_notify_hosts&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_priv_proto&quot;</span><span class="p">],</span>
             <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_priv_pwd&quot;</span><span class="p">],</span>
             <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_queries&quot;</span><span class="p">],</span>
             <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_query_port&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_security_level&quot;</span><span class="p">],</span>
             <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_source_ip&quot;</span><span class="p">],</span>
             <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_status&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_trap_rport&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;snmpv3_trap_status&quot;</span><span class="p">]])):</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_snmp_v3</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to create SNMP V3 Community&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_snmp_v3</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to create SNMP V3 Community&quot;</span><span class="p">)</span>

    <span class="c1"># PROCESS THE SYSLOG SETTINGS IF THE ALL THE NEEDED SYSLOG VARIABLES ARE PRESENT</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_port&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_mode&quot;</span><span class="p">],</span>
                                   <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_server&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_status&quot;</span><span class="p">]]):</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="c1"># enable syslog in the devprof template</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_syslog</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to set Syslog server&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="c1"># disable syslog in the devprof template</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_syslog</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete syslog server settings&quot;</span><span class="p">)</span>

    <span class="c1"># IF THE SYSLOG FILTER IS PRESENT THEN RUN THAT</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;syslog_filter&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="c1"># set the syslog filter level</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_syslog_filter</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to set syslog settings&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="c1"># remove the syslog filter level</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_syslog_filter</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete syslog settings&quot;</span><span class="p">)</span>

    <span class="c1"># PROCESS NTP OPTIONS</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_status&quot;</span><span class="p">]:</span>
        <span class="c1"># VALIDATE INPUT</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;custom&quot;</span> <span class="ow">and</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_server&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">module</span><span class="o">.</span><span class="n">exit_json</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s2">&quot;You requested custom NTP type but did not provide ntp_server parameter.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_auth&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;enable&quot;</span> <span class="ow">and</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;ntp_auth_pwd&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">module</span><span class="o">.</span><span class="n">exit_json</span><span class="p">(</span>
                <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;You requested NTP Authentication but did not provide ntp_auth_pwd parameter.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_ntp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to set NTP settings&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_ntp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete NTP settings&quot;</span><span class="p">)</span>

    <span class="c1"># PROCESS THE ADMIN OPTIONS</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">(</span>
            <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_https_redirect&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_https_port&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_http_port&quot;</span><span class="p">],</span>
            <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_timeout&quot;</span><span class="p">],</span>
            <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_language&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_switch_controller&quot;</span><span class="p">],</span>
            <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_gui_theme&quot;</span><span class="p">])):</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_admin</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to set NTP settings&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_admin</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete NTP settings&quot;</span><span class="p">)</span>

    <span class="c1"># PROCESS FORTIGUARD OPTIONS</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_enable_fortiguard&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_toggle_fg</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to toggle Fortiguard on/off&quot;</span><span class="p">)</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_fg</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to set Fortiguard settings&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span> <span class="ow">or</span> <span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">(</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_enable_fortiguard&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_fg</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete Fortiguard settings&quot;</span><span class="p">)</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_toggle_fg</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to toggle Fortiguard on/off&quot;</span><span class="p">)</span>

    <span class="c1"># PROCESS THE SMTP OPTIONS</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">(</span>
            <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_username&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_password&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_port&quot;</span><span class="p">],</span>
            <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_replyto&quot;</span><span class="p">],</span>
            <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_conn_sec&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_server&quot;</span><span class="p">],</span>
            <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_source_ipv4&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;smtp_validate_cert&quot;</span><span class="p">])):</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_smtp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to set SMTP settings&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_smtp</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete SMTP settings&quot;</span><span class="p">)</span>

    <span class="c1"># PROCESS THE DNS OPTIONS</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span>
           <span class="p">(</span><span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;dns_suffix&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;dns_primary_ipv4&quot;</span><span class="p">],</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;dns_secondary_ipv4&quot;</span><span class="p">])):</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_dns</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to set DNS settings&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_dns</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete DNS settings&quot;</span><span class="p">)</span>

    <span class="c1"># PROCESS THE admin_fortianalyzer_target OPTIONS</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;admin_fortianalyzer_target&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_faz</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to set FAZ settings&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_faz</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete FAZ settings&quot;</span><span class="p">)</span>

    <span class="c1"># PROCESS THE PROVISIONING TEMPLATE TARGET PARAMETER</span>
    <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provision_targets&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">set_devprof_scope</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to set provision targets&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;absent&quot;</span><span class="p">:</span>
            <span class="c1"># WE NEED TO FIGURE OUT WHAT&#39;S THERE FIRST, BEFORE WE CAN RUN THIS</span>
            <span class="n">targets_to_add</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">current_scope</span> <span class="o">=</span> <span class="n">get_devprof_scope</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
                <span class="n">targets_to_remove</span> <span class="o">=</span> <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;provision_targets&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                <span class="n">targets</span> <span class="o">=</span> <span class="n">current_scope</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;scope member&quot;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">target</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">targets_to_remove</span><span class="p">:</span>
                        <span class="n">target_append</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]}</span>
                        <span class="n">targets_to_add</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">target_append</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">paramgram</span><span class="p">[</span><span class="s2">&quot;targets_to_add&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">targets_to_add</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">delete_devprof_scope</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">paramgram</span><span class="p">)</span>
            <span class="n">fmgr_logout</span><span class="p">(</span><span class="n">fmg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">good_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10033</span><span class="p">,</span> <span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to delete provision targets&quot;</span><span class="p">)</span>

    <span class="n">fmg</span><span class="o">.</span><span class="n">logout</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">module</span><span class="o">.</span><span class="n">exit_json</span><span class="p">(</span><span class="o">**</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="fmgr_fortimeter.html" class="btn btn-neutral float-right" title="fmgr_fortimeter" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="fmgr_device_group.html" class="btn btn-neutral" title="fmgr_device_group" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Fortinet North American Core CSE - DevOps.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>